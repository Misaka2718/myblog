---
title: 3.1 雅可比三重乘积等式 (triple product)
createTime: 2026/01/18 17:55:41
permalink: /pi-agm/ch3/3.1
---


## 定理 3.1

对每对复数 $x, q$, $x \ne 0$ 且 $|q|<1$，有

$$ \quad \prod_{n=1}^{\infty} (1+xq^{2n-1})(1+x^{-1}q^{2n-1})(1-q^{2n}) = \sum_{n=-\infty}^{\infty} x^n q^{n^2} \tag{3.1.1}$$

**Proof.** 令

$$F(x, q) = \prod_{n=1}^{\infty} (1+xq^{2n-1})(1+x^{-1}q^{2n-1})$$

则 $F(\cdot, q)$ 是 除 0 外 解析的且 有在 0 处的洛朗展开。

注意到 $F(x, q) = F(x^{-1}, q)$ ;

$$\begin{aligned} F(xq^2, q) &= \prod_{n=1}^{\infty} (1+xq^{2n+1})(1+x^{-1}q^{2n-3}) \\ &= \frac{(1+x^{-1}q^{-1})}{1+xq} \prod_{n=1}^{\infty} (1+xq^{2n-1})(1+x^{-1}q^{2n-1}) \quad \text{(注：此处调整首项因子)} \end{aligned}$$

$$= \frac{1+\frac{1}{xq}}{1+xq} F(x, q) = \frac{1}{xq} F(x, q)$$

$$\text{则有} \quad F(x, q) = F(x^{-1}, q), \quad qx F(xq^2, q) = F(x, q)$$

令 $F(x, q)$ 有如下展开

$$F(x, q) = \sum_{n=-\infty}^{\infty} c_n(q) x^n$$

由 $F(x^{-1}, q) = F(x, q)$ 得 $c_n(q) = c_{-n}(q)$ ; 那考虑 $n \ge 0$ 的 $c_n(q)$ 好了。

由 $F(x, q) = qx F(xq^2, q)$ 有

$$\sum_{-\infty}^{\infty} c_n(q) x^n = \sum_{-\infty}^{\infty} q c_n(q) x^{n+1} q^{2n} = \sum_{-\infty}^{\infty} c_n(q) q^{2n+1} x^{n+1}$$

$$= \sum_{-\infty}^{\infty} q^{2n-1} c_{n-1}(q) x^n$$

则有 $c_n(q) = q^{2n-1} c_{n-1}(q), \quad n \ge 1$ 

则

$$\frac{c_n}{c_0} = \frac{c_n}{c_{n-1}} \frac{c_{n-1}}{c_{n-2}} \dots \frac{c_1}{c_0} = q^{1+3+\dots+(2n-1)} = q^{n^2}$$

$$\therefore \quad c_n(q) = q^{n^2} c_0(q), \quad n \ge 0$$

又由 $c_n(q) = c_{-n}(q)$，有 $c_{-n}(q) = q^{(-n)^2} c_0(q) = q^{n^2} c_0(q)$

所以

$$(3.1.2) \quad F(x, q) = c_0(q) \sum_{n=-\infty}^{\infty} x^n q^{n^2} \tag{3.1.2}$$

剩下确定 $c_0(q)$。 令 $x=1$ 在上式有 $c_0(q) \theta_3(q) = \prod_{n=1}^{\infty} (1+q^{2n-1})^2$

令 $x=-1$ 有 $c_0(q) \theta_4(q) = \prod_{n=1}^{\infty} (1-q^{2n-1})^2$，由 (2.1.7 ii)

$\sqrt{\theta_3(q)\theta_4(q)} = \theta_4(q^2)$

$$c_0^2(q) \theta_4(q) \theta_3(q) = \prod_{n=1}^{\infty} [(1+q^{2n-1})(1-q^{2n-1})]^2$$

$$c_0^2 \theta_4^2(q^2) = \prod_{n=1}^{\infty} (1-q^{4n-2})^2$$

则

$$c_0(q) \theta_4(q^2) = \prod_{n=1}^{\infty} (1-q^{4n-2})$$

但在 $x=-1$ 那式中 令 $q \to q^2$ 有

$$c_0(q^2) \theta_4(q^2) = \prod_{n=1}^{\infty} (1-q^{4n-2})^2$$

作商有

$$\frac{c_0(q^2)}{c_0(q)} = \prod_{n=1}^{\infty} (1-(q^2)^{2n-1})$$

这又提醒我们做连乘积，由于 $q^{2^k} \to 0 \ (k \to \infty)$

在 $F(x,q) = \sum c_n(q) x^n$ 中令 $q=0$ 得

$$F(x, 0) = \prod_{n=1}^{\infty} (1+0)(1+0)(1-0) = 1 = \sum c_n(0) x^n = c_0(0)$$

则有 $c_0(0) = 1$。由于 $c_0(q)$ 是在 0 处解析的：

$$c_0(q)^{-1} = \prod_{k=1}^{\infty} \frac{c_0(q^{2^k})}{c_0(q^{2^{k-1}})} = \prod_{k=1}^{\infty} \prod_{n=1}^{\infty} (1-q^{2^k(2n-1)})$$

由于 所有偶数可写成 $2^k(2n-1)$ 形式，即 2 的幂乘一奇数，

且这种分解是唯一的，则上述无穷乘积为

$$c_0(q)^{-1} = \prod_{m=1}^{\infty} (1-q^{2m})$$

在 (3.1.2) 代入 $c_0(q)$ 即得 (3.1.1)


**定义** $Q_0, Q_1, Q_2, Q_3$

$$ \quad Q_0 = \prod_{n=1}^{\infty} (1-q^{2n}) \qquad Q_1 = \prod_{n=1}^{\infty} (1+q^{2n}) \tag{3.1.3}$$

$$\quad \qquad Q_2 = \prod_{n=1}^{\infty} (1+q^{2n-1}) \qquad Q_3 = \prod_{n=1}^{\infty} (1-q^{2n-1})$$

**容易验证 欧拉等式**

$$\quad \prod_{n=1}^{\infty} (1+q^n) \prod_{n=1}^{\infty} (1-q^{2n-1}) = 1 \tag{3.1.4}$$

**Proof:** 菲砖。

$$\frac{1}{\prod_{n=1}^{\infty} (1-q^{2n-1})} = \frac{1}{(1-q)(1-q^3)(1-q^5)(1-q^7)\dots} \stackrel{?}{=} \prod_{n=1}^{\infty} (1+q^n)$$

因为 $(1+q)(1+q^2)(1+q^3)\dots$

$$= \frac{(1-q^2)(1-q^4)(1-q^6)\dots}{(1-q)(1-q^2)(1-q^3)\dots}$$

分子上 所含偶次项 总会被分母上的约去。则只剩含奇数次的 $q$ 幂了。

由于 $Q_1 Q_2 = \prod_{n=1}^{\infty} (1+q^n)$。 则 欧拉等式可写成

$$ \quad Q_1 Q_2 Q_3 = 1 \tag{3.1.4b}$$

**按照定义有**

$$ \quad Q_0 Q_1 = Q_0(q^2) \tag{3.1.5 i}$$

$$ \quad Q_0 Q_3 = Q_0(q^{\frac{1}{2}}) \tag{3.1.5 ii}$$

$$ \quad Q_2 Q_3 = Q_3(q^2) \tag{3.1.5 iii}$$

$$ \quad Q_1 Q_2 = Q_1(q^{\frac{1}{2}}) \tag{3.1.5 iv}$$

下面的 $\theta_i$ 函数与 $Q_i$ 的关系可由 三重乘积的 特别赋值得。



### 引理 3.1

对 $|q|<1$

$$ \quad \theta_3(q) = Q_0 Q_2^2 = \prod_{n=1}^{\infty} (1-q^{2n})(1+q^{2n-1})^2 \tag{3.1.6}$$

$$ \quad \theta_4(q) = Q_0 Q_3^2 = \prod_{n=1}^{\infty} (1-q^{2n})(1-q^{2n-1})^2 \tag{3.1.7}$$

$$ \quad \theta_2(q) = 2q^{\frac{1}{4}} Q_0 Q_1^2 = 2q^{\frac{1}{4}} \prod_{n=1}^{\infty} (1-q^{2n})(1+q^{2n})^2 \tag{3.1.8}$$

Proof: 在 (3.1.1) 中，令 $x=1$，则有 (3.1.6) 式。 令 $x=-1$，则有 (3.1.7) 式。由于 $\theta_2(q) = \sum_{n=-\infty}^{\infty} q^{(n+\frac{1}{2})^2} = q^{\frac{1}{4}} \sum_{n=-\infty}^{\infty} q^{n^2+n}$

则在 (3.1.1) 中令 $x=q$，有

$$\prod_{n=1}^{\infty} (1+q^{2n})(1+q^{2n-2})(1-q^{2n})$$

$$= 2 \prod_{n=1}^{\infty} (1+q^{2n})^2 (1-q^{2n}) = \sum_{n=-\infty}^{\infty} q^{n^2+n}$$

_(注：这里 $n=1$ 时中间项为 $(1+q^0)=2$)_

两边乘 $q^{\frac{1}{4}}$ 得 (3.1.8) 式。

更一般地，令 $k, l$ 为实数，做替换 $q \to q^k, \ x \to \pm q^l$ 在 (3.1.1) 有

$$\prod_{n=0}^{\infty} (1 \pm q^{2kn+k-l})(1 \pm q^{2kn+k+l})(1-q^{2kn+2k}) = \sum_{n=-\infty}^{\infty} (\pm 1)^n q^{kn^2+ln} \tag{3.1.9}$$

现在想在 (3.1.9) 中的乘积项的 $q$ 的幂跑遍所有自然数。

则 $2k=3, \ k=\frac{3}{2}$，$q^{2kn+2k} = q^{3n+3}$，还要 $q^{3n+1}$ 与 $q^{3n+2}$。

则 $\begin{cases} k-l=1 \\ k+l=2 \end{cases}$ 有 $l=\frac{1}{2}$。则

$$ \prod_{n=1}^{\infty} (1-q^n) = \sum_{n=-\infty}^{\infty} (-1)^n q^{(3n^2+n)/2} \tag{3.1.10}$$

这叫 欧拉五边形数定理 (Euler's pentagonal number theorem)

五边形数是 $\frac{n(3n-1)}{2}, \ n=1, 2, 3 \dots$

由于 (3.1.10) 是 $n=-\infty$ 到 $+\infty$ 求和，也可写成 

$$\sum_{-\infty}^{\infty} (-1)^{-n} q^{\frac{-n(3(-n)+1)}{2}}= \sum_{-\infty}^{\infty} (-1)^n q^{(3n^2-n)/2}$$


在 (3.1.9) 令 $k=l=\frac{1}{2}$，有

$$ \prod_{n=1}^{\infty} (1+q^n)(1-q^{2n}) = \frac{1}{2} \sum_{-\infty}^{\infty} q^{(n+1)n/2} = \prod_{n=1}^{\infty} \frac{1-q^{2n}}{1-q^{2n-1}} \tag{3.1.11}$$


最后等号由欧拉等式得，$\frac{1}{2}$ 是因为求和从 $n=1$ 而不是 $0$ 开始了。

这里最后 令 $k=\frac{5}{2}$， $l=\frac{3}{2}$ 和 $\frac{1}{2}$，分别给出 下面 Rogers-Ramanujan identities 公式：

$$ \prod_{n=0}^{\infty} (1-q^{5n+1})(1-q^{5n+4})(1-q^{5n+5}) = \sum_{n=-\infty}^{\infty} (-1)^n q^{(5n+3)n/2} \tag{3.1.12a}$$

$$ \prod_{n=0}^{\infty} (1-q^{5n+2})(1-q^{5n+3})(1-q^{5n+5}) = \sum_{n=-\infty}^{\infty} (-1)^n q^{(5n+1)n/2} \tag{3.1.12b}$$

**现在令** $q \to q^{\frac{1}{2}}, \quad x \to q^{\frac{1}{2}}w$ 在 (3.1.1) 有

$$\prod_{n=1}^{\infty} (1+q^{\frac{1}{2}}w q^{n-\frac{1}{2}})(1+q^{-\frac{1}{2}}w^{-1}q^{n-\frac{1}{2}})(1-q^n)$$

$$= \prod_{n=1}^{\infty} (1+wq^n)(1+w^{-1}q^{n-1})(1-q^n)$$

$$= (1+w^{-1}) \prod_{n=1}^{\infty} (1+wq^n)(1+w^{-1}q^n)(1-q^n) = \sum_{-\infty}^{\infty} w^n q^{\frac{n}{2}} q^{\frac{n^2}{2}}$$

**即**

$$\prod_{n=1}^{\infty} (1-q^n)(1+q^n w)(1+q^n w^{-1}) = \frac{w}{w+1} \sum_{-\infty}^{\infty} w^n q^{n(n+1)/2} \tag{3.1.13}$$

上式右端可改成

$$\begin{aligned} \frac{1}{1+w^{-1}} \sum_{-\infty}^{\infty} w^n q^{n(n+1)/2} &= \frac{1}{1+w^{-1}} \sum_{n=0}^{\infty} w^n q^{n(n+1)/2} + \frac{1}{1+w^{-1}} \sum_{n=1}^{\infty} w^{-n} q^{-n(-n+1)/2} \\ &= \frac{1}{1+w^{-1}} \sum_{n=0}^{\infty} w^n q^{n(n+1)/2} + \frac{1}{1+w^{-1}} \sum_{n=0}^{\infty} w^{-n-1} q^{n(n+1)/2} \\ &= \sum_{n=0}^{\infty} \frac{w^n + w^{-n-1}}{1+w^{-1}} q^{n(n+1)/2} \\ &= \sum_{n=0}^{\infty} w^{-n} \frac{w^{2n+1}+1}{w+1} q^{n(n+1)/2} \end{aligned}$$



令 $w \to -1$，由于 $\lim_{w \to -1} \frac{w^{2n+1}+1}{w+1} = \lim_{w \to -1} (2n+1)w^{2n} = 2n+1$ （洛必达法则）

则 (3.1.13) 左端为

$$\prod_{n=1}^{\infty} (1-q^n)^3 = \sum_{m=0}^{\infty} (-1)^m (2m+1) q^{m(m+1)/2} \tag{3.1.14}$$

用 (3.1.10) 得

$$\left[ \sum_{m=-\infty}^{\infty} (-1)^m q^{(3m+1)m/2} \right]^3 = \sum_{m=0}^{\infty} (-1)^m (2m+1) q^{m(m+1)/2} \tag{3.1.15}$$

几个练习题中的重要公式

由于 $\theta_3^4 = \theta_4^4 + \theta_2^4$，代入 (3.1.6) $\sim$ (3.1.8) 中有

$$Q_2^8 = Q_3^8 + 16q Q_1^8$$

**即**

$$\prod_{n=1}^{\infty} (1+q^{2n-1})^8 = \prod_{n=1}^{\infty} (1-q^{2n-1})^8 + 16q \prod_{n=1}^{\infty} (1+q^{2n})^8 \tag{3.1.16}$$

由于 $\theta_4(z, q) = 1 + 2\sum_{n=1}^{\infty} (-1)^n q^{n^2} \cos 2nz$

$$\begin{aligned} &= 1 + \sum_{n=1}^{\infty} (-1)^n q^{n^2} (e^{i2nz} + e^{-i2nz}) \\ &= 1 + \sum_{n=1}^{\infty} (-1)^n q^{n^2} e^{i2nz} + \sum_{n=1}^{\infty} (-1)^{-n} q^{(-n)^2} e^{-i2nz} \\ &= \sum_{n=-\infty}^{\infty} (-1)^n e^{i2nz} q^{n^2} \end{aligned}$$

则在 (3.1.1) 中，令 $x = -e^{i2z}$ 有

$$\prod_{n=1}^{\infty} (1 - e^{i2z} q^{2n-1})(1 - e^{-i2z} q^{2n-1})(1-q^{2n})$$

$$= \prod_{n=1}^{\infty} (1 - 2q^{2n-1} \cos 2z + q^{4n-2}) \prod_{n=1}^{\infty} (1-q^{2n}) = \sum_{n=-\infty}^{\infty} (-1)^n e^{i2nz} q^{n^2}$$

**即**

$$\theta_4(z, q) = \prod_{n=1}^{\infty} (1 - 2q^{2n-1} \cos 2z + q^{4n-2}) \prod_{n=1}^{\infty} (1-q^{2n}) \tag{3.1.17}$$

$z=0$ 时又得 (3.1.7) 式

