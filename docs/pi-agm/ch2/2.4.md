---
title: 2.4 一些迭代公式的源头与其一些收敛结果
createTime: 2026/01/17 
permalink: /pi-agm/ch2/2.4
order: 4
---

从 Exercise 2 of 1.6 被 $\sqrt{2} K(1/\sqrt{2})\dot{K}(1/\sqrt{2}) = \pi$ 启发，

我们着手计算 $\dot{K}$。如果在 AGM 迭代中，把 $a_0=1, \ b_0=k$ 是个变量，容易说明 $a_n, b_n$ 都是 $k$ 的连续序列且 $a_n(k), b_n(k)$ 可导（由递归定义， $a_n(k), b_n(k)$ 都是一堆连续函数的复合）。

又 $\lim a_n$ 与 $\lim b_n$ 都一致收敛（甚至一致二阶收敛，则 $M(1, k)$ 是 $k$ 的连续函数。可以证明 $\dot{a}_n, \dot{b}_n$ 是 一致收敛的（对于 $k \in (0, +\infty)$ 的紧子集上）见数分吧，那么 $\dot{a}_n, \dot{b}_n$ 收敛到 $\dot{M}(1, k)$。

用上 $M(1, k) = \frac{\pi}{2K(k')}$ （注：此处笔记对应的是 $b_0=k$ 收敛到 $M(1,k)$ 的情况，故 $M(1,k) = \frac{\pi}{2K(k')}$，其中 $k'=\sqrt{1-k^2}$） 有

$$ \quad \dot{M}(1, k) = \frac{\pi}{2} \frac{k}{k'} \frac{\dot{K}(k')}{K^2(k')} \tag{2.4.1}$$

(回顾 $\frac{dk'}{dk} = -\frac{k}{k'}$, 代入 $\frac{dK(k')}{dk} = \frac{dK(k')}{dk'} \frac{dk'}{dk}$， 或简写作 $\dot{K}(k')$ )

$$\quad \dot{K}(k') = \frac{\pi}{2} \frac{k'}{k} \frac{\dot{M}(1, k)}{M^2(1, k)} \tag{2.4.2}$$

(代入 $K^2(k') = \frac{\pi^2}{4 M^2(1, k)}$ )

现在 写数列为

$$\dot{a}_{n+1} = \frac{\dot{a}_n + \dot{b}_n}{2}, \quad \dot{b}_{n+1} = (\sqrt{a_n b_n})' = \frac{\dot{a}_n b_n + a_n \dot{b}_n}{2\sqrt{a_n b_n}} = \frac{\dot{a}_n b_n + a_n \dot{b}_n}{2 b_{n+1}}$$

把 $\dot{a}_n, \dot{b}_n$ 看作新的序列，它们的递推公式如下：

$$ \quad \dot{a}_{n+1} = \frac{\dot{a}_n + \dot{b}_n}{2}, \quad \dot{b}_{n+1} = \frac{\dot{a}_n b_n + \dot{b}_n a_n}{2 b_{n+1}} \tag{2.4.3}$$

由于 $a_n/b_n$ 二阶收敛到 1 （这可由 $a_n, b_n$ 都是二阶收敛得出？）

（其实是 $k_n'$ 二阶收敛）。容易说明 $\dot{a}_n, \dot{b}_n$ 也是二阶收敛到 $\dot{M}(1, k)$ 的 ($k \in (0, 1)$ )。且 $\dot{a}_n$ 是递增的， $\dot{b}_n$ 是递减的 （至少对充分大的 $n$）。见练习 1。


定义 $x_n, y_n$

令 $x_n = a_n/b_n, \quad y_n = \dot{b}_n / \dot{a}_n$

则 $x_{n+1} = \frac{a_{n+1}}{b_{n+1}} = \frac{\frac{1}{2}(a_n+b_n)}{\sqrt{a_n b_n}} = \frac{1}{2} (\sqrt{\frac{a_n}{b_n}} + \sqrt{\frac{b_n}{a_n}}) = \frac{1}{2} (\sqrt{x_n} + \frac{1}{\sqrt{x_n}})$

$$y_{n+1} = \frac{\dot{b}_{n+1}}{\dot{a}_{n+1}} = \frac{\frac{1}{2}(\dot{a}_n \sqrt{\frac{b_n}{a_n}} + \dot{b}_n \sqrt{\frac{a_n}{b_n}})}{\frac{1}{2}(\dot{a}_n + \dot{b}_n)} = \frac{\dot{a}_n/\sqrt{x_n} + \dot{b}_n \sqrt{x_n}}{\dot{a}_n + \dot{b}_n} = \frac{1/\sqrt{x_n} + y_n \sqrt{x_n}}{1 + y_n}$$

$$x_{n+1} = \frac{\sqrt{x_n} + 1/\sqrt{x_n}}{2}, \quad y_{n+1} = \frac{y_n \sqrt{x_n} + 1/\sqrt{x_n}}{y_n+1} \tag{2.4.4}$$

此处 $x_0 = k^{-1}, \quad y_1 = \sqrt{x_0}, \quad y_0$ 是不定义的。 $y_1 = \frac{\dot{b}_1}{\dot{a}_1} = \frac{\frac{1}{2\sqrt{k}}}{\frac{1}{2}} = \frac{1}{\sqrt{k}}$

此外，还有

$$1 \le x_{n+1} \le y_{n+1} \le \sqrt{x_n} \le x_n \tag{2.4.5}$$

Proof. $x_{n+1} = \frac{\frac{1}{\sqrt{x_n}} + \sqrt{x_n}}{2} \ge \frac{2}{2} = 1$ (基本不等式 $x + \frac{1}{x} \ge 2$)

再证 $y_{n+1} \ge 1$. 用数归纳法. $y_1 = \frac{1}{\sqrt{k}} > 1$。 假设 $y_n \ge 1$.

则 $\frac{y_n}{1+y_n} \ge 0.5, \quad \frac{1}{1+y_n} \le 0.5$

设 $f(x) = a\sqrt{x} + (1-a)\frac{1}{\sqrt{x}}$, 其中 $a \ge 0.5, \quad x \ge 1$.

$f'(x) = \frac{a}{2\sqrt{x}} - \frac{1-a}{2} \frac{1}{x\sqrt{x}} = 0$. 解得 $x = \frac{1-a}{a} \le 1$ 为唯一极小值点.

$\therefore f(x)$ 在 $x > \frac{1-a}{a}$ 后单增

$f(x) \ge f(1) = a + (1-a) = 1$

$\therefore$ 若当 $a = \frac{y_n}{y_n+1}, \quad x = x_n \ge 1$ 有

$y_{n+1} = f(x_n) = \frac{y_n}{y_{n+1}} \sqrt{x_n} + \frac{1}{y_{n+1}} \frac{1}{\sqrt{x_n}} \ge 1$

由归纳法得 $y_{n+1} \ge 1$ 成立.

**再证** $x_{n+1} \le y_{n+1}$ 代入 (2.4.4) 即证

$$\frac{1}{2} (\sqrt{x_n} + \frac{1}{\sqrt{x_n}}) \le \frac{y_n}{y_n+1} \sqrt{x_n} + \frac{1}{y_n+1} \frac{1}{\sqrt{x_n}} \quad \text{合并同类项}$$

**即**

$$\frac{y_n-1}{2} \sqrt{x_n} \ge \frac{y_n-1}{2} \frac{1}{\sqrt{x_n}} \quad \text{又由 } y_n \ge 1 \text{ 有 } \sqrt{x_n} \ge \frac{1}{\sqrt{x_n}}$$


由于 $x_n \ge 1$，则成立不等式 ($x_{n+1} \ge 1, \ n=0, 1, 2 \dots$ 但 $x_0 = \frac{1}{k} > 1$ 也对)

**再证** $y_{n+1} \le \sqrt{x_n}$。 代入 (2.4.4)

即证 $\frac{y_n}{y_n+1} \sqrt{x_n} + \frac{1}{y_n+1} \frac{1}{\sqrt{x_n}} \le \sqrt{x_n} \quad \text{即}$

$$\frac{1}{y_n+1} \frac{1}{\sqrt{x_n}} \le \frac{1}{y_n+1} \sqrt{x_n}$$

又由 $x_n \ge 1$ 得。 最后 $\sqrt{x_n} \le x_n$ 由 $x_n \ge 1$ 得。

由于 $\frac{a_n}{b_n} \to 1$。 看 $x_n - 1$ 有什么。

$$\begin{aligned} x_{n+1} - 1 &= \frac{\sqrt{x_n} + \frac{1}{\sqrt{x_n}}}{2} - 1 = \frac{\sqrt{x_n} + \frac{1}{\sqrt{x_n}} - 2}{2} = \frac{x_n - 2\sqrt{x_n} + 1}{2\sqrt{x_n}} = \frac{(\sqrt{x_n}-1)^2}{2\sqrt{x_n}} \\ &= \frac{(x_n-1)^2}{2\sqrt{x_n}(1+\sqrt{x_n})^2} \end{aligned}$$

又 $1+\sqrt{x_n} \ge 2$，则 $2\sqrt{x_n}(1+\sqrt{x_n})^2 \ge 2 \cdot 2^2 = 8$

$$\therefore \quad x_{n+1} - 1 = \frac{(x_n-1)^2}{2\sqrt{x_n}(1+\sqrt{x_n})^2} \le \frac{1}{8} (x_n-1)^2$$

$$\begin{aligned} y_{n+1} - 1 &= \frac{y_n \sqrt{x_n} + 1/\sqrt{x_n}}{y_n+1} - \frac{y_n+1}{y_n+1} = \frac{(y_n \sqrt{x_n} + \frac{1}{\sqrt{x_n}} - y_n - 1)(\sqrt{x_n}+1)}{(y_n+1)(\sqrt{x_n}+1)} \\ &= \frac{y_n x_n + 1/\sqrt{x_n} \cdot \sqrt{x_n} - y_n \sqrt{x_n} - \sqrt{x_n} + y_n \sqrt{x_n} + \frac{1}{\sqrt{x_n}} - y_n - 1}{(y_n+1)(\sqrt{x_n}+1)} \\ &= \frac{x_n y_n - y_n - \sqrt{x_n} + 1/\sqrt{x_n} }{(y_n+1)(\sqrt{x_n}+1)} \\ &= \frac{(x_n-1)(y_n-1)}{(y_n+1)(\sqrt{x_n}+1)} + \frac{\frac{1}{\sqrt{x_n}} + x_n - \sqrt{x_n} - 1}{(y_n+1)(\sqrt{x_n}+1)} \end{aligned}$$



(注：此处对应右侧关于第二项分子的化简)

$$\begin{aligned} \text{分子} &= \frac{1-x_n}{\sqrt{x_n}} + x_n - 1 \\ &= (x_n-1)(1 - \frac{1}{\sqrt{x_n}}) \\ &= (\sqrt{x_n}-1)(\sqrt{x_n}-\frac{1}{\sqrt{x_n}}) \end{aligned}$$
又 
$$\begin{aligned} \frac{(\sqrt{x_n}-1)(\sqrt{x_n}-\frac{1}{\sqrt{x_n}})}{(\sqrt{x_n}+1)}&= \frac{\sqrt{x_n}-1}{\sqrt{x_n}+1} \frac{x_n-1}{\sqrt{x_n}} = \frac{(\sqrt{x_n}-1)^2}{\sqrt{x_n}} \\ &= \frac{x_n+1-2\sqrt{x_n}}{\sqrt{x_n}} \\ &= \frac{1}{\sqrt{x_n}} + \sqrt{x_n} - 2 \\ &= 2(x_{n+1}-1) \end{aligned}$$


$$\therefore \quad y_{n+1} - 1 = \frac{(y_n-1)(x_n-1)}{(y_n+1)(\sqrt{x_n}+1)} + \frac{2(x_{n+1}-1)}{y_n+1}$$

$$\text{又 } (2.4.5) \text{ 中 } 1 \le x_n \le y_n, \quad x_n-1 \le y_n-1$$

$$y_{n+1} \ge 2, \quad \sqrt{x_n}+1 \ge 2, \quad (x_{n+1}-1) \le \frac{1}{8}(x_n-1)^2 \le \frac{1}{8}(y_n-1)^2 \text{ 有}$$

$$y_{n+1}-1 \le \frac{1}{4}(y_n-1)^2 + \frac{2}{2} \frac{1}{8} (y_n-1)^2 \le \frac{1}{4}(y_n-1)^2 + \frac{1}{8}(y_n-1)^2 = \frac{3}{8}(y_n-1)^2$$

$\therefore \quad \text{对 } n \ge 1$

$$\quad x_{n+1}-1 \le \frac{1}{8} (x_n-1)^2 \tag{2.4.6 i}$$

$$ \quad y_{n+1}-1 \le \frac{3}{8} (y_n-1)^2 \tag{2.4.6 ii}$$

上面二式 说明 $\{x_n\}$ 与 $\{y_n\}$ 的 二阶收敛到 1。

在 (2.4.2) 代入 $k'=k=\frac{1}{\sqrt{2}}, \quad \dot{K}(\frac{1}{\sqrt{2}}) = \frac{\pi}{\sqrt{2} K(1/\sqrt{2})}$ 有

$$\frac{\pi}{\sqrt{2}} \frac{1}{K(1/\sqrt{2})} = \frac{\pi}{2} \frac{\dot{M}(1, 1/\sqrt{2})}{M^2(1, 1/\sqrt{2})}$$

$$\therefore \quad \pi = \frac{1}{2}\sqrt{2}\pi \frac{\dot{M}(1, 1/\sqrt{2})}{M^2(1, 1/\sqrt{2})} K(1/\sqrt{2})$$

$$= \frac{1}{2}\sqrt{2}\pi \frac{\dot{M}}{M^2} \frac{\pi}{2} \frac{1}{M(1, 1/\sqrt{2})}$$

$$= \frac{\pi^2}{2\sqrt{2}} \frac{\dot{M}}{M^3}$$

解出 $\pi$ 有

$$\pi = 2\sqrt{2} \frac{M^3(1, 1/\sqrt{2})}{\dot{M}(1, 1/\sqrt{2})}$$