---
title: π与AGM笔记
createTime: 2026/01/16 
permalink: /mathtest/ch1/1.6
---

## 1.6 勒让德关系式

笔记先跳过 1.5 节，1.5 节算死人了！

定理 1.6 勒让德关系式

对 $k \in (0,1)$

$$E(k)K'(k) + E'(k)K(k) - K(k)K'(k) = \frac{\pi}{2} \tag{1.6.0}$$

或

$$EK' + E'K - KK' = \frac{\pi}{2}$$

**Proof.** 令 $G = k^{\frac{1}{2}} k' K, \quad G^* = k^{\frac{1}{2}} k' K'$。由 1.5 节 (1.5.1) 式

$$\frac{\ddot{G}}{G} = \frac{\ddot{G}^*}{G^*}$$

即 $\ddot{G}G^* - G\ddot{G}^* = 0$。即这里插入一个郎可夫斯基行列式的性质。

> 王高雄《常微分方程》第四版 习题 4.1 6
> 
> 设 $x_1(t), x_2(t)$ 都是
> 
> $$x'' + a_1(t)x' + a_2(t)x = 0$$
> 
> 的解，$a_1(t)$ 与 $a_2(t)$ 于区间 $[a,b]$ 上连续。则
> 
> $$W'[x_1, x_2] + a_1(t) W[x_1, x_2] = 0$$
> 
> $$W[x_1, x_2] = \begin{vmatrix} x_1 & x_2 \\ x_1' & x_2' \end{vmatrix} = x_1 x_2' - x_1' x_2$$
> 
> $$W'[x_1, x_2] = x_1 x_2'' - x_1'' x_2$$

则由于 $\frac{\ddot{G}}{G} = \frac{\ddot{G}^*}{G^*} = p(k)$

则 $G, G^*$ 都是 $\ddot{y} - p(k)y = 0$ 的解。由蓝字（上述定理）

$$W'[G, G^*] + 0 \cdot W[G, G^*] = 0$$

$$\therefore \quad W'[G, G^*] = 0, \quad \text{即 (或由 } \ddot{G}G^* - G\ddot{G}^* = 0 \text{ 推出)}$$

$$W[G, G^*] = \text{常数}$$

即

$$\dot{G}G^* - \dot{G}^*G = C \tag{1.6.1}$$

代入 $G = k^{\frac{1}{2}} k' K, \quad G^* = k^{\frac{1}{2}} k' K'$

由于 $\frac{d(k^{\frac{1}{2}}k')}{dk} = \frac{1-3k^2}{2\sqrt{k}k'} = D$



$$\begin{aligned} \dot{G} &= DK + k^{\frac{1}{2}}k' \dot{K} \\ \dot{G}^* &= DK' + k^{\frac{1}{2}}k' \dot{K}' \end{aligned}$$

$$\begin{aligned} \dot{G}G^* - \dot{G}^*G &= (DK + k^{\frac{1}{2}}k'\dot{K}) k^{\frac{1}{2}}k'K' - (DK' + k^{\frac{1}{2}}k'\dot{K}') k^{\frac{1}{2}}k'K \\ &= k^{\frac{1}{2}}k' [ DK K' + k^{\frac{1}{2}}k'\dot{K}K' - DK'K - k^{\frac{1}{2}}k'\dot{K}'K ] \\ &= k^{\frac{1}{2}}k' [ k^{\frac{1}{2}}k' (\dot{K}K' - \dot{K}'K) ] \\ &= k(1-k^2)(\dot{K}K' - K\dot{K}') = C \end{aligned}$$

$$k(1-k^2)(\dot{K}K' - K\dot{K}') = C \tag{1.6.2}$$

用上

$$\frac{dK}{dk} = \frac{E-(1-k^2)K}{k(1-k^2)} = \frac{E-k'^2K}{kk'^2}$$

求计算 $\frac{dK'}{dk} = \frac{dK(k')}{dk'} \left(-\frac{k}{k'}\right)$， $\frac{dK(k')}{dk'} = \frac{E' - k^2 K'}{k' k^2}$

$$\therefore \quad \frac{dK'}{dk} = \frac{k^2 K' - E'}{k k'^2}$$

从而 $k(1-k^2)\dot{K} = E - k'^2 K$

$$k(1-k^2)\dot{K}' = k^2 K' - E'$$

代入 (1.6.2)

$$\begin{aligned} & k(1-k^2)\dot{K}K' - k(1-k^2)\dot{K}'K \\ &= (E - k'^2 K)K' - (k^2 K' - E')K \\ &= EK' - k'^2 KK' - k^2 K'K + E'K \\ &= EK' + E'K - (k'^2+k^2)KK' \\ &= EK' + E'K - KK' = C \end{aligned}$$

我们还需确定 $C$。

$$EK' + E'K - KK' = C \tag{1.6.3}$$

书里想用上述函数在 0 处的展开，但不必这么麻烦。

参照菲砖 [511] 12)

$$\lim_{k \to 0} E = \frac{\pi}{2}$$

$$\lim_{k \to 0} K = \frac{\pi}{2}, \quad \lim_{k \to 0} E' = \lim_{k' \to 1} \int_0^{\frac{\pi}{2}} \sqrt{1-k'^2\sin^2\varphi} d\varphi = \int_0^{\frac{\pi}{2}} \cos\varphi d\varphi = 1$$

麻烦的是 $EK' - KK' = K'(E-K)$ 这项， $\lim_{k \to 0} K' = +\infty$ 是 $\infty \cdot 0$ 不定型。

但

$$K' = \int_0^{\frac{\pi}{2}} \frac{d\theta}{\sqrt{1-k'^2\sin^2\theta}} < \frac{\pi}{2} \frac{1}{\sqrt{1-k'^2}} = \frac{\pi}{2k}$$

$$|E-K| = K-E = \int_0^{\frac{\pi}{2}} \frac{k^2\sin^2\theta}{\sqrt{1-k^2\sin^2\theta}} d\theta < \frac{\pi}{2} \frac{k^2}{k'} \quad (\text{因 } \sin^2\theta \le 1, \text{分母} \ge \sqrt{1-k^2}=k')$$

$$\therefore \quad |K'(E-K)| < \frac{\pi}{2k} \cdot \frac{\pi}{2} \frac{k^2}{k'} = \frac{\pi^2}{4} \frac{k}{k'} \to 0 \quad \text{当 } k \to 0 \quad (k' \to 1)$$

$$\therefore \quad \lim_{k \to 0} K'(E-K) = 0$$

$$\text{则 } C = \lim_{k \to 0} K'(E-K) + \lim_{k \to 0} E'K = 0 + 1 \cdot \frac{\pi}{2} = \frac{\pi}{2}$$

**定义 gamma 函数 beta 函数**

$$\Gamma(x) = \int_0^{+\infty} e^{-t} t^{x-1} dt, \quad \text{Re}(x) > 0 \tag{1.6.4}$$

$$B(x,y) = \int_0^1 t^{x-1}(1-t)^{y-1} dt, \quad \text{Re}(x), \text{Re}(y) > 0 \tag{1.6.5}$$

**gamma 函数的互余变量公式**

$$\Gamma(x)\Gamma(1-x) = \frac{\pi}{\sin \pi x} \tag{1.6.6}$$

**$\Gamma$ 与 $B$ 的关系**

$$B(x,y) = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)} \tag{1.6.7}$$



## 定理 1.7

$$K(\frac{1}{\sqrt{2}}) = \frac{\Gamma^2(\frac{1}{4})}{4\sqrt{\pi}}$$

$$E(\frac{1}{\sqrt{2}}) = \frac{4\Gamma^2(\frac{3}{4}) + \Gamma^2(\frac{1}{4})}{8\sqrt{\pi}}$$

**Proof.** 按定义

$$\begin{aligned} K(\frac{1}{\sqrt{2}}) &= \int_0^1 \frac{dt}{\sqrt{(1-t^2)(1-\frac{1}{2}t^2)}} \\ &= \sqrt{2} \int_0^1 \frac{dt}{\sqrt{(1-t^2)(2-t^2)}} \end{aligned}$$

**换元** $x^2 = t^2/(2-t^2)$， $x = t/\sqrt{2-t^2}$， $(0,1) \to (0,1)$

$$2x dx = \frac{4t}{(2-t^2)^2} dt, \quad t^2 = \frac{2x^2}{1+x^2} \quad dt = \frac{x}{2t}(2-t^2)^2 dx$$

$$\frac{x}{t} = \frac{1}{\sqrt{2-t^2}}, \quad 1-t^2 = \frac{1-x^2}{1+x^2}, \quad 2-t^2 = \frac{2}{1+x^2}, \quad 2-t^2 = \frac{t^2}{x^2}$$

$$\begin{aligned} \frac{dt}{\sqrt{(1-t^2)(2-t^2)}} &= \frac{\frac{x}{2t}(2-t^2)^2 dx}{\sqrt{\frac{1-x^2}{1+x^2} \frac{2}{1+x^2}}} \\ &= \frac{(1+x^2) \frac{x}{2t} \frac{t^4}{x^4} dx}{\sqrt{2(1-x^2)}} = \frac{1}{2} \frac{(1+x^2) \frac{t^3}{x^3} dx}{\sqrt{2(1-x^2)}} \end{aligned}$$

$$\begin{aligned} &= \frac{1}{2} \frac{(1+x^2)(\sqrt{2-t^2})^3 dx}{\sqrt{2} \sqrt{1-x^2}} = \frac{1}{2} \frac{(1+x^2) \sqrt{\frac{2}{1+x^2}} \frac{2}{1+x^2}}{\sqrt{2} \sqrt{1-x^2}} dx \\ &= \frac{2}{2} \frac{\sqrt{2}}{\sqrt{2}} \frac{\sqrt{1+x^2}}{1+x^2} \frac{1}{\sqrt{1-x^2}} dx\\&= \frac{1}{\sqrt{1-x^4}} dx \end{aligned}$$

_(注：此处推导过程笔记中有涂改和简写，最终化简为下式)_

$$= \frac{1}{\sqrt{1-x^4}} dx$$

$$\therefore \quad \sqrt{2} \int_0^1 \frac{dt}{\sqrt{(1-t^2)(2-t^2)}} = \sqrt{2} \int_0^1 \frac{dx}{\sqrt{1-x^4}} \quad \text{这时能解释 (1.2.1) 了}$$

接下来用 $\beta$ 函数。令 $u=x^4, \quad x=u^{\frac{1}{4}}, \quad dx=\frac{1}{4}u^{-\frac{3}{4}} du$

$$\sqrt{2} \int_0^1 \frac{dx}{\sqrt{1-x^4}} = \frac{\sqrt{2}}{4} \int_0^1 u^{-\frac{3}{4}}(1-u)^{-\frac{1}{2}} du$$


$$= \frac{\sqrt{2}}{4} \int_0^1 u^{\frac{1}{4}-1} (1-u)^{\frac{1}{2}-1} du$$

$$= \frac{\sqrt{2}}{4} B(\frac{1}{4}, \frac{1}{2}) = \frac{\sqrt{2}}{4} \frac{\Gamma(\frac{1}{4})\Gamma(\frac{1}{2})}{\Gamma(\frac{3}{4})}$$

又 $\Gamma(\frac{1}{2}) = \sqrt{\pi}, \quad \Gamma(\frac{3}{4})\Gamma(\frac{1}{4}) = \frac{\pi}{\sin \frac{\pi}{4}} = \sqrt{2}\pi$

$$\therefore \quad \frac{\sqrt{2}}{4} \frac{\Gamma(\frac{1}{4})\Gamma(\frac{1}{2})}{\Gamma(\frac{3}{4})} = \frac{\sqrt{2}}{4} \frac{\Gamma(\frac{1}{4})\sqrt{\pi}}{\frac{\sqrt{2}\pi}{\Gamma(\frac{1}{4})}} = \frac{\Gamma^2(\frac{1}{4})}{4\sqrt{\pi}}$$

$$\text{则} \quad K(\frac{1}{\sqrt{2}}) = \frac{\Gamma^2(\frac{1}{4})}{4\sqrt{\pi}}$$

**另一个做法是**

$$K(\frac{1}{\sqrt{2}}) = \int_0^{\frac{\pi}{2}} \frac{d\theta}{\sqrt{1-\frac{1}{2}\sin^2\theta}}$$

这里令 $x = \cos\theta$！ $dx = -\sin\theta d\theta, \quad d\theta = \frac{-dx}{\sin\theta} = \frac{-dx}{\sqrt{1-x^2}}$

$$\frac{d\theta}{\sqrt{1-\frac{1}{2}\sin^2\theta}} = \frac{-dx}{\sqrt{1-x^2}\sqrt{1-\frac{1}{2}(1-x^2)}} = -\frac{dx}{\sqrt{1-x^2}\sqrt{\frac{1+x^2}{2}}} = -\sqrt{2} \frac{dx}{\sqrt{1-x^4}}$$

又 $(0, \frac{\pi}{2}) \to (1, 0)$

$$\therefore \quad \int_0^{\frac{\pi}{2}} \frac{d\theta}{\sqrt{1-\frac{1}{2}\sin^2\theta}} = -\sqrt{2} \int_1^0 \frac{dx}{\sqrt{1-x^4}} = \sqrt{2} \int_0^1 \frac{dx}{\sqrt{1-x^4}}$$

**对 $E(\frac{1}{\sqrt{2}})$ 的计算**

$$E(\frac{1}{\sqrt{2}}) = \int_0^1 \frac{\sqrt{1-\frac{1}{2}t^2}}{\sqrt{1-t^2}} dt$$

令 $u = \sqrt{1-t^2}, \quad t = \sqrt{1-u^2}, \quad dt = \frac{-u du}{\sqrt{1-u^2}}$

$$\begin{aligned} \frac{\sqrt{1-\frac{1}{2}t^2}}{\sqrt{1-t^2}} dt &= \frac{\sqrt{1-\frac{1}{2}(1-u^2)}}{u} \frac{(-u) du}{\sqrt{1-u^2}} = - \frac{\sqrt{\frac{1+u^2}{2}}}{\sqrt{1-u^2}} du \\ &= -\frac{1}{\sqrt{2}} \frac{\sqrt{1+u^2}}{\sqrt{1-u^2}} du = -\frac{1}{\sqrt{2}} \frac{1+u^2}{\sqrt{1-u^4}} du \\ &= -\frac{1}{\sqrt{2}} \frac{u^2}{\sqrt{1-u^4}} du - \frac{1}{\sqrt{2}} \frac{1}{\sqrt{1-u^4}} du \end{aligned}$$

又 $(0, 1) \to (1, 0)$

$$\therefore \quad E(\frac{1}{\sqrt{2}}) = \frac{1}{\sqrt{2}} \int_0^1 \frac{u^2}{\sqrt{1-u^4}} du + \frac{1}{\sqrt{2}} \int_0^1 \frac{1}{\sqrt{1-u^4}} du$$



第二个积分算过了，为 $\frac{1}{\sqrt{2}} \int_0^1 \frac{1}{\sqrt{1-u^4}} du = \frac{1}{2} K(\frac{1}{\sqrt{2}})$

$$\begin{aligned} \frac{1}{\sqrt{2}} \int_0^1 \frac{u^2}{\sqrt{1-u^4}} du &\xlongequal{t=u^4} \frac{1}{\sqrt{2}} \int_0^1 \frac{t^{\frac{1}{2}}}{\sqrt{1-t}} \frac{1}{4} t^{\frac{1}{4}-1} dt \\ &= \frac{1}{4\sqrt{2}} \int_0^1 t^{-\frac{1}{4}}(1-t)^{-\frac{1}{2}} dt = \frac{1}{4\sqrt{2}} B(\frac{3}{4}, \frac{1}{2}) \\ &= \frac{1}{4\sqrt{2}} \frac{\Gamma(\frac{3}{4})\Gamma(\frac{1}{2})}{\Gamma(\frac{5}{4})} = \frac{1}{4\sqrt{2}} \frac{\Gamma(\frac{3}{4})\sqrt{\pi}}{\frac{1}{4}\Gamma(\frac{1}{4})} = \frac{\sqrt{\pi}}{\sqrt{2}} \frac{\Gamma(\frac{3}{4})}{\frac{\sqrt{2}\pi}{\Gamma(\frac{3}{4})}} = \frac{\pi \Gamma^2(\frac{3}{4})}{2\sqrt{\pi}\pi} \text{ (注:此处化简)} \\ &= \frac{\Gamma^2(\frac{3}{4})}{2\sqrt{\pi}} \end{aligned}$$

$$\therefore \quad E(\frac{1}{\sqrt{2}}) = \frac{\Gamma^2(\frac{3}{4})}{2\sqrt{\pi}} + \frac{\Gamma^2(\frac{1}{4})}{8\sqrt{\pi}} = \frac{4\Gamma^2(\frac{3}{4}) + \Gamma^2(\frac{1}{4})}{8\sqrt{\pi}}$$

使用 $k=\frac{1}{\sqrt{2}}$，有 $E(1/\sqrt{2}) = E'(1/\sqrt{2}), \quad K(1/\sqrt{2}) = K'(1/\sqrt{2})$

则 在 勒让德关系 那有

$$C = E(\frac{1}{\sqrt{2}})K(\frac{1}{\sqrt{2}}) + E(\frac{1}{\sqrt{2}})K(\frac{1}{\sqrt{2}}) - K(\frac{1}{\sqrt{2}})^2 = 2E(\frac{1}{\sqrt{2}})K(\frac{1}{\sqrt{2}}) - K(\frac{1}{\sqrt{2}})^2$$

把 $E(\frac{1}{\sqrt{2}}), K(\frac{1}{\sqrt{2}})$ 的 $\Gamma$ 表达代进去就得到 $C$。避免了渐进展开。

$$\begin{aligned} & 2E(\frac{1}{\sqrt{2}})K(\frac{1}{\sqrt{2}}) - K(\frac{1}{\sqrt{2}})^2 \\ &= 2 \frac{4\Gamma^2(\frac{3}{4}) + \Gamma^2(\frac{1}{4})}{8\sqrt{\pi}} \cdot \frac{\Gamma^2(\frac{1}{4})}{4\sqrt{\pi}} - \frac{\Gamma^4(\frac{1}{4})}{16\pi} \\ &= \frac{4\Gamma^2(\frac{3}{4})\Gamma^2(\frac{1}{4}) + \Gamma^4(\frac{1}{4}) - \Gamma^4(\frac{1}{4})}{16\pi} \\ &= \frac{(\sqrt{2}\pi)^2}{4\pi} = \frac{2\pi^2}{4\pi} = \frac{\pi}{2} \end{aligned}$$

_(注：记得互余宗量公式)：$4\Gamma^2(\frac{3}{4})\Gamma^2(\frac{1}{4}) = 4[\Gamma(\frac{3}{4})\Gamma(\frac{1}{4})]^2 = 4(\sqrt{2}\pi)^2 = 8\pi^2$，代入分子为 $8\pi^2 / 16\pi = \pi/2$)_



由于

$$\frac{2K(1/\sqrt{2})}{\pi} \left[ \frac{2E(1/\sqrt{2})}{\pi} - \frac{K(1/\sqrt{2})}{\pi} \right] = \frac{1}{\pi}$$

而 $\frac{K(1/\sqrt{2})}{\pi}, \frac{E(1/\sqrt{2})}{\pi}$ 可由之前的 算法 1.1, 1.2 求得，这给出了一个计算 $\dfrac{1}{\pi}$ 的做法。

**定义 $K'/K$ 的那些 $k$ 值**

使 $K'/K$ 为一些有理根号和有理数的 $k$，叫 singular values（奇异值）。最简单的奇异值为 $\frac{1}{\sqrt{2}}$。

$$\frac{K'}{K}(\frac{1}{\sqrt{2}}) = 1$$

勒让德发现 $(\sqrt{3}-1)/\sqrt{8}$ 也是一个

$$\frac{K'}{K}\left(\frac{\sqrt{3}-1}{\sqrt{8}}\right) = \sqrt{3}$$

在 **算法定理 1.2**： $K(k) = \frac{1}{1+k} K(\frac{2\sqrt{k}}{1+k})$

令 $k = \frac{2\sqrt{k}}{1+k}$，即 $\sqrt{k} = \frac{2}{1+k}$。令 $\sqrt{k}=t$， $t = \frac{2}{1+t^2}$ 解得 $t=$ 虚数。

$$K(k) = \frac{1}{1+k} K'\left(\frac{1-k}{1+k}\right)$$

令 $k = \frac{1-k}{1+k}$，解得 $k = \sqrt{2}-1$ ！

$$\therefore \quad \frac{K}{K'}(\sqrt{2}-1) = \frac{1}{1+\sqrt{2}-1} = \frac{1}{\sqrt{2}}$$

$$\frac{K'}{K}(\sqrt{2}-1) = \sqrt{2}$$