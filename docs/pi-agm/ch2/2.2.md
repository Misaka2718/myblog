---
title: 2.2 泊松求和公式
createTime: 2026/01/17 
permalink: /pi-agm/ch2/2.2
order: 2
---

---


定理 2.2

令 $f$ 是非负函数，在 $(-\infty, 0]$ 上单增，在 $[0, \infty)$ 上单减。

假设 $\int_{-\infty}^{\infty} f(x) dx$ 存在。则对 $\forall x \in \mathbb{R}$，

$$\sum_{n=-\infty}^{\infty} \frac{f(n+x) + f(n+x-)}{2} = \sum_{k=-\infty}^{\infty} e^{2\pi i k x} \int_{-\infty}^{\infty} f(t) e^{-2\pi i k t} dt \tag{2.2.1}$$

每个级数都绝对收敛。

**Proof.** 见 Apostol 数学分析 11.22 泊松求和公式：定理 11.24 (13) 式。

**例 2.1** $\coth x$ 的部分分式分解

将定理 2.2 用于函数

$$f(x) = \begin{cases} e^{-yx}, & x \ge 0 \\ 0, & x < 0 \end{cases}, \quad \text{此处 } y > 0$$

则

$$\int_{-\infty}^{\infty} f(t) e^{-2\pi i k t} dt = \int_0^{\infty} e^{-yt} e^{-2\pi i k t} dt = \frac{1}{y + 2\pi i k}$$

右边级数为

$$\begin{aligned} \sum_{k=-\infty}^{\infty} \frac{e^{2\pi i k x}}{y + 2\pi i k} &= \frac{1}{y} + \sum_{k=1}^{\infty} \frac{e^{2\pi i k x}}{y + 2\pi i k} + \sum_{k=1}^{\infty} \frac{e^{2\pi i (-k) x}}{y - 2\pi i k} \\ &= \frac{1}{y} + 2 \sum_{k=1}^{\infty} \text{Re} \frac{e^{2\pi i k x}}{y + 2\pi i k} \end{aligned}$$

$$\begin{aligned} \frac{e^{2\pi i k x}}{y + 2\pi i k} &= \frac{\cos(2\pi k x) + i \sin(2\pi k x)}{y + 2\pi i k} \\ &= \frac{[\cos(2\pi k x) + i \sin(2\pi k x)](y - i 2\pi k)}{y^2 + (2\pi k)^2} \end{aligned}$$

$$\therefore \quad \sum_{k=-\infty}^{\infty} \frac{e^{2\pi i k x}}{y + 2\pi i k} = \frac{1}{y} + 2 \sum_{k=1}^{\infty} \frac{y \cos(2\pi k x) + (2\pi k) \sin(2\pi k x)}{y^2 + (2\pi k)^2}$$

左端

$$\sum_{n=-\infty}^{\infty} \frac{f(n+x) + f(n+x-)}{2} \quad \text{由于 } f(n+x) = \begin{cases} e^{-y(n+x)} & x \ge -n \\ 0 & x < -n \end{cases}$$



则对 固定 $x$，加项只有 $n \ge -x$ 才非零

$$\sum = \sum_{n \ge -x} \frac{f(n+x)+f(n+x-)}{2} = \sum_{n > -x} + \sum_{n=-x}$$

当 $x \in \mathbb{Z}$，由于 $f(x)$ 在 $x=0$ 处有跳跃，则 $n=-x$ 这项

$$\frac{f(0+)+f(0-)}{2} = \frac{1+0}{2} = \frac{1}{2}$$

当 $x \notin \mathbb{Z}$，则 $f(x)$ 是在 $n+x$ 处连续的，$n=-x$ 这项没有， $n > -x$ 的项

$$\frac{f(n+x)+f(n+x-)}{2} = f(n+x)$$

$\therefore$ 左边和式为

$$\sum_{n > -x} e^{-y(n+x)} + \begin{cases} \frac{1}{2}, & x \in \mathbb{Z} \\ 0, & \text{其他} \end{cases}$$

**若 $x=0 \in \mathbb{Z}$ 则 左式**

$$\frac{1}{2} + \sum_{n>0} e^{-yn} = \frac{1}{2} + \sum_{n=1}^{\infty} e^{-ny} = \frac{1}{2} + \frac{e^{-y}}{1-e^{-y}} = \frac{1}{2} + \frac{1}{e^y-1}$$

**右式**

$$= \frac{1}{y} + 2y \sum_{k=1}^{\infty} \frac{1}{y^2+(2\pi k)^2}$$

$$\therefore \quad \frac{1}{2} + \frac{1}{e^y-1} = \frac{1}{y} + 2y \sum_{k=1}^{\infty} \frac{1}{y^2+(2\pi k)^2}$$

令 $y=2\pi x$。

$$\coth(\pi x) = \frac{e^{2\pi x}+1}{e^{2\pi x}-1} = 1 + \frac{2}{e^{2\pi x}-1} = 2\left(\frac{1}{2} + \frac{1}{e^{2\pi x}-1}\right)$$

$$\therefore \quad \frac{1}{2} + \frac{1}{e^{2\pi x}-1} = \frac{1}{2\pi x} + 2 \cdot 2\pi x \sum_{k=1}^{\infty} \frac{1}{(2\pi)^2 x^2 + (2\pi)^2 k^2}$$

$$\frac{1}{2} \coth(\pi x) = \frac{1}{2\pi x} + \frac{2\pi x}{2\pi} \sum_{k=1}^{\infty} \frac{1}{x^2+k^2} \quad \text{两边同乘 } 2\pi \text{ 有}$$

$$\tag{2.2.2} \quad \pi \coth(\pi x) = \frac{1}{x} + 2x \sum_{n=1}^{\infty} \frac{1}{x^2+n^2}$$

这式子本来对 $x>0$ 对，但由于 $\coth(\pi x)$ 是奇函数，则对 $x<0$ 也对。

**若 $x=\frac{1}{2} \notin \mathbb{Z}$ 则 左式**

$$\begin{aligned} \sum_{n > -\frac{1}{2}}^{\infty} e^{-y(n+\frac{1}{2})} &= \sum_{n=0}^{\infty} e^{-y(n+\frac{1}{2})} = \frac{e^{-\frac{y}{2}}}{1-e^{-y}} = \frac{1}{e^{\frac{y}{2}} - e^{-\frac{y}{2}}} \\ &= \frac{1}{2} \frac{1}{\sinh \frac{y}{2}} \end{aligned}$$


**右式**

$$\frac{1}{y} + 2 \sum_{k=1}^{\infty} \frac{y \cos(\pi k)}{y^2+(2\pi k)^2} = \frac{1}{y} + \sum_{k=1}^{\infty} \frac{y(-1)^k}{y^2+(2\pi k)^2}$$

又令 $y=2\pi x$，得

$$\frac{1}{2 \sinh \pi x} = \frac{1}{2\pi x} + \sum_{k=1}^{\infty} \frac{2\pi x \cdot (-1)^k}{(2\pi)^2 x^2 + (2\pi)^2 k^2}, \quad \text{两边乘 } 2\pi$$

得

$$\tag{2.2.3} \quad \pi \text{cosech}(\pi x) = \frac{1}{x} + 2x \sum_{k=1}^{\infty} \frac{(-1)^k}{x^2+k^2}$$

不用虚数单位的一个做法。更多的三角函数展开见 练习 1。

**例 2. (也可在 Apostol 数分中找到)**

将 (2.2.1) 用于

$$f(x) = e^{-s\pi x^2}, \quad s > 0$$

这函数处处连续，则

$$\sum_{n=-\infty}^{\infty} e^{-s(n+x)^2\pi} = \sum_{k=-\infty}^{\infty} e^{2\pi i k x} \int_{-\infty}^{\infty} e^{-st^2\pi - 2\pi i k t} dt$$

由于 $e^{-2\pi i k t} = \cos(2\pi k t) - i \sin(2\pi k t)$

$$\int_{-\infty}^{\infty} e^{-st^2\pi} e^{-2\pi i k t} dt = \int_0^{+\infty} + \int_{-\infty}^0$$

$$\begin{aligned} &= \int_0^{\infty} e^{-st^2\pi} e^{-2\pi i k t} dt + \int_0^{\infty} e^{-st^2\pi} e^{2\pi i k t} dt \\ &= \int_0^{\infty} e^{-st^2\pi} (e^{-2\pi i k t} + e^{2\pi i k t}) dt \\ &= 2 \int_0^{\infty} e^{-st^2\pi} \cos(2\pi k t) dt, \quad \text{令 } st^2\pi = u^2 \end{aligned}$$

$$\begin{aligned} &= \frac{2}{\sqrt{s\pi}} \int_0^{+\infty} e^{-u^2} \cos(2k\sqrt{\frac{\pi}{s}} u) du \\ &= \frac{2}{\sqrt{s\pi}} F(\sqrt{\frac{\pi}{s}} k). \end{aligned}$$

其中 $F(y) = \int_0^{\infty} e^{-x^2} \cos(2xy) dx = \frac{\sqrt{\pi}}{2} e^{-y^2}$


$F(y)$ 可以用微分方程求解

$$\begin{aligned} \dot{F}(y) &= \int_0^{+\infty} e^{-x^2} \sin(2xy)(-2x) dx \\ &= - \int_0^\infty e^{-x^2} \cdot 2x \cdot \sin(2xy) dx \\ &= + \int_0^\infty \sin(2xy) d(e^{-x^2}) \\ &= \left. e^{-x^2} \sin(2xy) \right|_0^\infty - \int_0^\infty e^{-x^2} \cos(2xy) 2y dx \\ &= -2y \int_0^\infty e^{-x^2} \cos(2xy) dy \\ &= -2y F(y) \end{aligned}$$

$$\therefore \quad \dot{F}(y) + 2y F(y) = 0$$

解微分方程（分离变量法）得

$$F(y) = C e^{-y^2}$$

又 $F(0) = \int_0^\infty e^{-x^2} dx = \frac{\sqrt{\pi}}{2}$，则

$$F(y) = \frac{\sqrt{\pi}}{2} e^{-y^2} \tag{2.2.4}$$

则 $F(\sqrt{\frac{\pi}{s}} k) = \frac{\sqrt{\pi}}{2} e^{-\frac{\pi}{s} k^2}$

因为有（结合上一页的推导结果）

$$\sum_{n=-\infty}^{\infty} e^{-s(n+x)^2 \pi} = s^{-\frac{1}{2}} \sum_{k=-\infty}^{\infty} e^{2\pi i k x} e^{-\pi k^2/s} \tag{2.2.5}$$

分析的进一步结果说明对 $\text{Re}(s) > 0$ 的复数 $s$ 也对。该式称为 **theta 转换方程** (theta transformation formula)。

令 $x=0$ 有

$$\sum_{n=-\infty}^{\infty} e^{-s\pi n^2} = s^{-\frac{1}{2}} \sum_{k=-\infty}^{\infty} e^{-\frac{\pi}{s} n^2}$$

后面约定

$$\theta_i(s) = \theta_i(e^{-\pi s})$$

即用 $s$ 作变量时。

把 $\theta_i(s)$ 理解为

$$\theta_i(q)|_{q=e^{-\pi s}}$$

则 $x=0$ 时有

$$\sqrt{s} \theta_3(s) = \theta_3(s^{-1}) \tag{2.2.6}$$

注意 等式两端级数收敛快慢。对于大的 $s$， $s^{-1}$ 反而小。

从而 $e^{-\pi s}$ 更小，$e^{-\pi/s}$ 更大点（接近 1），$\sqrt{s}\theta_3(s)$ 收敛会快很多过 $\theta_3(s^{-1})$。