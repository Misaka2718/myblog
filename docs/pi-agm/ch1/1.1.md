---
title: 1.1 算术几何平均 AGM
createTime: 2026/01/16 
permalink: /pi-agm/ch1/1.1
---

# Chapter One

## 1.1 算术几何平均 AGM

### 

**定义** $a_n, b_n, c_n$

$$\begin{align} \tag{1.1.1} \quad & a_{n+1} = \frac{1}{2}(a_n + b_n) \\ \tag{1.1.2} \quad & b_{n+1} = \sqrt{a_n b_n} \\ \tag{1.1.3} \quad & c_{n+1} = \frac{1}{2}(a_n - b_n) \end{align}$$

并且假设 $a_0 \ge b_0 > 0$。

这就导出了极限 $a_n, b_n$。事实上：

$$b_n \le b_{n+1} \le a_{n+1} \le a_n$$

这是由 $\frac{1}{2}(x+y) \ge \sqrt{xy}$ 得到的。关于两者之差，可看到一个二次收敛的事情：

$$\tag{1.1.4} \quad 0 \le a_{n+1} - b_{n+1} = \frac{1}{2} \frac{(a_n - b_n)^2}{(\sqrt{a_n} + \sqrt{b_n})^2}$$

**Process:**

$$\begin{aligned} a_{n+1} - b_{n+1} &= \frac{1}{2}(a_n + b_n) - \sqrt{a_n b_n} \\ &= \frac{1}{2} \frac{a_n^2 + a_n b_n + 2a_n\sqrt{a_n b_n} + b_n a_n + b_n^2 + 2b_n\sqrt{a_n b_n}}{a_n + b_n + 2\sqrt{a_n b_n}} \\ &\quad - \frac{1}{2} \frac{(2a_n + 2b_n)\sqrt{a_n b_n} + 4a_n b_n}{a_n + b_n + 2\sqrt{a_n b_n}} \\ &= \frac{1}{2} \frac{a_n^2 + b_n^2 - 2a_n b_n}{a_n + b_n + 2\sqrt{a_n b_n}} \\ &= \frac{1}{2} \frac{(a_n - b_n)^2}{(\sqrt{a_n} + \sqrt{b_n})^2} \end{aligned}$$

以后的笔记将不记页数计入 "Process"。

由于 $\{a_n\}$ 单减，$\{b_n\}$ 单增而都有界，则由 $(1.1.4)$ 二者极限相等。

**定义 $M(a,b)$**

$$M(a,b) = \lim a_n = \lim b_n \tag{1.1.5}$$

这儿 $a=a_0, b=b_0$。$M(a,b)$ 只与数列初值有关。

定义, pth-order 收敛, p阶收敛

一个数列 p 阶收敛，如果

$$\left| \frac{\alpha_{n+1} - \alpha}{(\alpha_n - \alpha)^p} \right| = O(1) \tag{1.1.6}$$

即

$$|\alpha_{n+1} - \alpha| \le M |\alpha_n - \alpha|^p$$

$M$ 是一个固定常数。还能引出一致 p 阶收敛（这时 $O(1)$ 与 $x$ 无关那种）。

二阶收敛在数值计算上，粗略表明小数收敛速度是二倍指数般。

可以证明，AGM: $M(a,b)$ 是对任意 $a,b \in (0, +\infty)^2$ 的紧子集是一致二阶收敛的。更精致的 $M(a,b)$ 估计在后文。

**Process:**

我借 $c_n$ 和 $a_n, b_n$ 的单调性说明这点。由于 $b_n \le a_n$

$$b_n \le L \le a_n, \quad L=M(a,b)$$

得 $0 \le a_n - L \le a_n - b_n$, $0 \le L - b_n \le a_n - b_n$

那么，说明 $c_n = a_n - b_n$ 的收敛速度足够多了。由 $(1.1.4)$

$$c_{n+1} = \frac{1}{2} \frac{c_n^2}{(\sqrt{a_n} + \sqrt{b_n})^2} = \frac{1}{2} \frac{c_n^2}{a_n + b_n + 2\sqrt{a_n b_n}} = \frac{1}{4} \frac{c_n^2}{(a_{n+1} + b_{n+1})}$$

$$\therefore \lim_{n \to \infty} \frac{c_{n+1}}{c_n^2} = \lim_{n \to \infty} \frac{1}{4(a_{n+1} + b_{n+1})} = \frac{1}{8L}$$

则 $c_n$ 是二阶收敛的。下证明在 $K \subset (0, \infty)^2$ 上的紧子集上是一致二阶收敛的。

紧子集 $K$ 的性质是：对任意 $(a,b) \in K$，存在固定常数 $A$，

$$a \ge A, \quad b \ge A$$

又 $L \ge b_n \ge b_1 = \sqrt{ab}$，则 $L \ge A$。

这就找到与 $a,b$ 无关的 $M(a,b)$ 的下界。由于

$$a_{n+2} = \frac{a_{n+1}+b_{n+1}}{2} \ge L \ge A \quad (a_n \text{ 递减趋于 } L)$$

则

$$\frac{1}{4(a_{n+1}+b_{n+1})} = \frac{1}{8a_{n+2}} \le \frac{1}{8L} \le \frac{1}{8A}$$

$$\therefore \quad c_{n+1} \le \frac{c_n^2}{8A}$$

$\{c_n\}$ 是一致二阶收敛的。但是我们还是要说明下一致二阶收敛的魏尔斯特拉斯判别法？有吗？

令

$$e_a(n) = a_n - L$$

$$e_b(n) = L - b_n$$

$e_a(n), e_b(n) \ge 0$。我们用 $\{c_n\}$ 导出 $\{e_a(n)\}$ 的关系。

$$c_n = a_n - b_n = e_a(n) + e_b(n)$$

$$e_a(n+1) = a_{n+1} - L = \frac{a_n+b_n - 2L}{2} = \frac{e_a(n) - e_b(n)}{2} \ge 0$$

则

$$e_a(n) \ge e_b(n)$$

$$c_n = e_a(n) + e_b(n) \le 2e_a(n)$$

又

$$e_a(n+1) \le c_{n+1} \le \frac{c_n^2}{8A} \le \frac{4e_a^2(n)}{8A}$$

$$\therefore \quad e_a(n) \text{ 是一致二阶收敛的。}$$

关于 $e_b(n)$ 呢？这个比 $e_a(n)$ 复杂得多。

定理

关于 $M(a,b)$，有个齐次性，对 $\lambda > 0$

$$\lambda M(a,b) = M(\lambda a, \lambda b) \tag{1.1.7}$$

Process: 令 $a'_n = \lambda a_n$，则仍有 $b'_n = \lambda b_n$

$$a'_{n+1} = \frac{1}{2}(a'_n + b'_n) = \lambda \frac{a_n+b_n}{2} = \lambda a_{n+1}$$

$$b'_{n+1} = \sqrt{a'_n b'_n} = \lambda \sqrt{a_n b_n} = \lambda b_{n+1}$$

则 $\lim a'_n = \lim b'_n = M(\lambda a, \lambda b) = \lambda \lim a_n = \lambda M(a,b)$

有时利用这齐次性消去 $a$ 的影响。

由于

$$M(a,b) = M(\frac{a+b}{2}, \sqrt{ab}) \tag{1.1.8}$$

Process: $a'_n = a_{n+1}, \quad b'_n = b_{n+1}$，则 $a'_0 = a_1 = \frac{a+b}{2}, \quad b'_0 = \sqrt{ab}$。

又 $a'_{n+1} = \frac{a'_n+b'_n}{2}, \quad b'_{n+1} = \sqrt{a'_n b'_n}$ 则

$$\lim a'_n = M(\frac{a+b}{2}, \sqrt{ab}) = \lim a_{n+1} = \lim a_n = M(a,b)$$

令 $a=1$，有 $M(1,b) = M(\frac{1+b}{2}, \sqrt{b})$

利用齐次性提出 $\frac{1+b}{2}$ 有

$$M(1,b) = \frac{1+b}{2} M(1, \frac{2\sqrt{b}}{1+b}) \tag{1.1.9}$$

这时关于二元函数 $M$ 的性质由 1.1.9 刻出 ($M(a,b) = a M(1, \frac{b}{a})$)

这时让我们想解一个函数方程

$$f(x) = \frac{1+x}{2} f(\frac{2\sqrt{x}}{1+x}) \tag{1.1.10}$$

由于这式子对 $\forall x > 0$ 成立，可以弄个无穷乘积 "$x \to \frac{2\sqrt{x}}{1+x}$" 先定义一个 $k_n$

定义 $k_n$

令 $k_0 = x \in (0,1)$

$$k_{n+1} = \frac{2\sqrt{k_n}}{1+k_n} \tag{1.1.11}$$

即使 $k_0$ 不在 $x \in (0,1)$，它的下一项 $k_1$ 肯定 $\in (0,1)$。因为 $1+x > 2\sqrt{x}$

$k_1 < 1$ 了。（不考虑 $k_0=1$）

那么，

$$\begin{aligned} f(x) = f(k_0) &= \frac{1+k_0}{2} f(k_1) = \frac{1+k_0}{2} \frac{1+k_1}{2} f(k_2) = \cdots \\ &= \frac{1+k_0}{2} \cdots \frac{1+k_n}{2} f(k_{n+1}) \end{aligned}$$

由于

$$1 - k_{n+1} = 1 - \frac{2\sqrt{k_n}}{1+k_n} = \frac{1+k_n-2\sqrt{k_n}}{1+k_n} = \frac{(1-\sqrt{k_n})^2}{1+k_n} = \frac{(1-k_n)^2}{(1+\sqrt{k_n})^2(1+k_n)}$$

下面是$F(x) = \frac{2\sqrt{x}}{1+x}$ 图像
![[agm_matlab_plot.png]]
图1.1

由不动点迭代理论，$F'(1)=0,F"(1)\ne0,  k_n \to 1$，由上式还是二阶收敛致 1。

假若可以说明 $f(x)$ 是连续的，那么

$$f(x) = \prod_{j=0}^{n} \frac{1+k_j}{2} f(k_{n+1}) = f(1) \prod_{n=0}^{\infty} \frac{1+k_n}{2} \quad k_0 := x \tag{1.1.12}$$

记解为 $g(x)$，

$$g(x) := a \prod_{n=0}^{\infty} \frac{1+k_n}{2}, \quad k_0 := x$$

这时 $a=g(1)$。说明 $g(1)=a$ 是 $(1.1.10)$ 的解，还是在 1 邻域内解析的。

---

**记号 $k', \dot{g}$**

这书以 $k'$ 表示补量 (complement)$k'=\sqrt{1-k^2}$，导数反用牛顿记号 $\dot{g}(x) = \frac{dg}{dx}$。