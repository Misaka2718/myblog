---
title: 2.1 对 AGM 一个 theta 函数的解
createTime: 2026/01/17 
permalink: /pi-agm/ch2/2.1
order: 1
---



## 2.1 对 AGM 一个 theta 函数的解

**定义** $\theta_2, \theta_3, \theta_4$

**基础 theta 函数**， $|q|<1$ ，定义如下

$$\theta_2(q) = \sum_{n=-\infty}^{\infty} q^{(n+1/2)^2}, \quad \theta_2(0)=0 \tag{2.1.1}$$

$$\theta_3(q) = \sum_{n=-\infty}^{\infty} q^{n^2}, \quad \theta_3(0)=1 \tag{2.1.2}$$

$$\theta_4(q) = \sum_{n=-\infty}^{\infty} (-1)^n q^{n^2}, \quad \theta_4(0)=1 \tag{2.1.3}$$

Theta 函数有很多理论互相联系，和数论关系紧密。

$\theta_4(q) = \theta_3(-q)$，因为 $(-q)^{n^2} = (-1)^{n^2} q^{n^2}$，而 $n^2$ 的奇偶性与 $n$ 相同，因此

$$\theta_3(q) + \theta_4(q) = 2 \sum_{n \text{ even}} q^{n^2} = 2\theta_3(q^4) \tag{2.1.4}$$

现在看 $\theta_3^2$ 与 $\theta_4^2$

$$\theta_3^2 = \sum_{n=-\infty}^{\infty} q^{n^2} \sum_{m=-\infty}^{\infty} q^{m^2} = \sum_{m,n=-\infty}^{\infty} q^{m^2+n^2} = \sum_{n=0}^{\infty} r_2(n) q^n$$

$$\begin{align*}
\theta_4^2 &= \sum_{n=-\infty}^{\infty} (-1)^n q^{n^2} \sum_{m=-\infty}^{\infty} (-1)^m q^{m^2} \\&= \sum_{m,n=-\infty}^{\infty} (-1)^{m+n} q^{m^2+n^2} = \sum_{n=0}^{\infty} (-1)^n r_2(n) q^n \tag{2.1.5}
\end{align*}$$

这里 $r_2(n)$ 是整数 $n$ 有多少种被写成两个整数平方和 $n=j^2+k^2$ 的方法数。如 $r_2(5)=8$，因为 $5=(\pm 2)^2+(\pm 1)^2 = (\pm 1)^2+(\pm 2)^2$。

且令 $r_2(0)=1$。可以说明 $r_2(2n) = r_2(n)$。

Process 由于 $2a^2+2b^2 = (a+b)^2 + (a-b)^2$。

我们说明，每一个 $n$ 的写法对应 $2n$ 的一个写法。

每一个 $2n$ 的写法对应 $n$ 的一个写法，且不重不漏。

设 $n = j^2+k^2$，则 $2n = (j+k)^2 + (j-k)^2$。

若 $2n = l^2+m^2$，则 $n = (\frac{l+m}{2})^2 + (\frac{l-m}{2})^2$ （由于 $2n$ 为偶数， $l,m$ 奇偶性相同）


这产生了某种一一映射。则 $r_2(2n) = r_2(n)$

关于 $r_1(n)$ 是什么？ $\theta_3(q) = \sum r_1(n)q^n$ 是整数 $n$ 可以被写成一个平方数的方法数。

将 $\theta_3^2$ 和 $\theta_4^2$ 相加

$$\theta_3^2(q) + \theta_4^2(q) = 2 \sum_{n=0}^{\infty} r_2(2n) q^{2n} = 2 \sum_{n=0}^{\infty} r_2(n) (q^2)^n = 2\theta_3^2(q^2) \tag{2.1.6}$$

用 (2.1.4), (2.1.6) 可解 $\theta_3(q)\theta_4(q)$

$$\begin{aligned} \theta_3(q)\theta_4(q) &= \frac{1}{2} (\theta_3(q) + \theta_4(q))^2 - \frac{1}{2} (\theta_3^2(q) + \theta_4^2(q)) \\ &\xlongequal{(2.1.4), (2.1.6)} \frac{1}{2} [2\theta_3(q^4)]^2 - \frac{1}{2} \cdot 2\theta_3^2(q^2) \\ &= 2\theta_3^2(q^4) - \theta_3^2(q^2) \end{aligned}$$

再在 (2.1.6) 中代替 $q \to q^2$

$$\theta_3^2(q^2) + \theta_4^2(q^2) = 2\theta_3^2(q^4)$$

$$\therefore \quad \theta_3(q)\theta_4(q) = \theta_4^2(q^2)$$

因此，

$$\tag{2.1.7 i} \quad \frac{\theta_3^2(q) + \theta_4^2(q)}{2} = \theta_3^2(q^2)$$

$$\tag{2.1.7  ii } \quad \sqrt{\theta_3^2(q)\theta_4^2(q)} = \theta_4^2(q^2)$$

$(\theta_3 > 0, \theta_4 > 0, \text{有 } \theta_4(q^2) > 0 \text{ 上面开根还是 } \theta_3(q)\theta_4(q))$

这 (2.1.7 i) 与 (2.1.7 ii) 刚好符合 AGM 迭代。类似看 $c_n$ (看 $a_n - b_n$)

$$\begin{aligned} \theta_3^2(q) - \theta_3^2(q^2) &= \sum_{n=0}^{\infty} r_2(n)q^n - \sum_{n=0}^{\infty} r_2(2n)q^{2n} \\ &= \sum_{n=0}^{\infty} r_2(2n+1)q^{2n+1} \\ &= \sum_{\substack{k,m=-\infty \\ k+m \text{ odd}}}^{\infty} q^{m^2+k^2} \end{aligned}$$


最后一个式子 $k+m$ 为奇，是要求 $k, m$ 奇偶性不同， $k^2+m^2$ 才可是奇数（跑遍 $2n+1$）

现令 $k=i-j, \quad m=i+j+1, \quad k+m=2i+1$

$$\begin{aligned} k^2+m^2 &= i^2+j^2-2ij + i^2+j^2+1+2ij+2i+2j \\ &= 2i^2+2j^2+2i+2j+1 \\ &= 2(i^2+j^2+i+j+\frac{1}{2}) \\ &= 2((i+\frac{1}{2})^2 + (j+\frac{1}{2})^2) \end{aligned}$$

$$\therefore \quad \sum_{\substack{k,m=-\infty \\ k+m=\text{odd}}}^{\infty} q^{m^2+k^2} = \sum_{i,j=-\infty}^{\infty} (q^2)^{(i+\frac{1}{2})^2+(j+\frac{1}{2})^2} = \theta_2^2(q^2)$$

因而

$$\tag{2.1.8} \quad \theta_3^2(q^2) + \theta_2^2(q^2) = \theta_3^2(q)$$

把上式 $\theta_3^2(q)$ 代入 (2.1.7 i)

$$\frac{\theta_3^2(q^2)+\theta_2^2(q^2)+\theta_4^2(q)}{2} = \theta_3^2(q^2) \quad \text{解得出 } \theta_4^2(q)$$

$$\tag{2.1.9} \quad \theta_3^2(q^2) - \theta_2^2(q^2) = \theta_4^2(q)$$

(2.1.8) 与 (2.1.9) 相乘，使用平方差公式 与 $\theta_3(q)\theta_4(q) = \theta_4^2(q^2)$

$$\theta_3^4(q^2) - \theta_2^4(q^2) = \theta_3^2(q)\theta_4^2(q) = \theta_4^4(q^2)$$

则

$$\theta_3^4(q^2) = \theta_4^4(q^2) + \theta_2^4(q^2)$$

把 $q^2$ 换成 $q$，有 **雅可比等式** (对于 $q<0$ 仍需讨论，或形式级数)

$$\tag{2.1.10} \quad \theta_3^4(q) = \theta_4^4(q) + \theta_2^4(q)$$

现在，把 $\theta_3^2(q)$ 当作 $a$， $\theta_4^2(q)$ 当作 $b$。 $c^2 = a^2-b^2 = \theta_3^4-\theta_4^4 = \theta_2^4$

$$k = k(q) = \frac{c}{a} = \frac{\theta_2^2(q)}{\theta_3^2(q)} \quad k' = \frac{\theta_4^2(q)}{\theta_3^2(q)}$$


**定义 $a_n, b_n$ 与 $q$ 有关**

$$a_n = \theta_3^2(q^{2^n}) \quad b_n = \theta_4^2(q^{2^n})$$

$$k_n' = \frac{b_n}{a_n} = \frac{\theta_4^2(q^{2^n})}{\theta_3^2(q^{2^n})}, \quad k_n = \frac{c_n}{a_n} = \frac{\theta_2^2(q^{2^n})}{\theta_3^2(q^{2^n})}$$

$a_n, b_n$ 由于 (2.1.7)

满足 AGM 迭代关系，又 $a_0 = \theta_3^2(q), \quad b_0 = \theta_4^2(q)$

当 $n \to \infty$，由于 $2^n \to +\infty, \quad |q|<1$，则 $q^{2^n} \to 0$

$$\therefore \quad \lim a_n = \theta_3^2(0) = 1$$

$$M(\theta_3^2(q), \theta_4^2(q)) = 1 \tag{2.1.11}$$

定理 2.1

令 $0 < k < 1$，$k$ 给定，则

$$M(1, k') = \theta_3^{-2}(q) \quad \text{对 } k' = \frac{\theta_4^2(q)}{\theta_3^2(q)} \tag{2.1.12}$$

这儿 $q$ 是 $(0,1)$ 中的 $k = \theta_2^2(q)/\theta_3^2(q)$ 的唯一解。特别地存在。

$$K(k) = \frac{\pi}{2} \theta_3^2(q) \tag{2.1.13}$$

**Proof.** 由 (2.1.11) 式与 $M$ 函数齐次性有

$$M\left(1, \frac{\theta_4^2(q)}{\theta_3^2(q)}\right) = \frac{1}{\theta_3^2(q)}$$

代入 $k'$ 即可得 (2.1.12)。由定理 1.1 K-AGM 关系有

$$K(k) = \frac{\pi}{2} \frac{1}{M(1, k')} = \frac{\pi}{2} \theta_3^2(q)$$

关于 $q$ 的唯一性与解的存在性 见 3.1 节。