---
title: 3.2 一些更深层次的 theta 函数等式
createTime: 2026/01/18 17:55:41
permalink: /pi-agm/ch3/3.2
---


**定义** $\lambda^*(r)$

$$\lambda^*(r) = k(e^{-\pi\sqrt{r}})$$

在 $k(q)$ 中令 $q = e^{-\pi\sqrt{r}}$ 而已. (把 $s$ 换成 $\sqrt{r}$ 了)

用上 更精细的 $k = 4\sqrt{q} + O(q)$，有 (把 $O(q)$ 主部分出)

$$0 \le 4e^{-\pi\sqrt{r}/2} - \lambda^*(r) = 16e^{-3\pi\sqrt{r}/2} + O(e^{-5\pi\sqrt{r}/2}) \tag{3.2.1}$$

(从 $\theta$ 函数展开得 $k = \frac{\theta_2^2(q)}{\theta_3^2(q)}$ )。由于 $\lambda^*$ 由 模 $k$ 定义 有 与定理 2.3 (b)

$$\frac{K'}{K}(\lambda^*(r)) = \sqrt{r} \tag{3.2.2}$$

从 引理 3.1

$$\frac{\theta_2(q)}{\theta_3(q)} = \sqrt{k} = 2q^{\frac{1}{4}} \prod_{n=1}^{\infty} \left( \frac{1+q^{2n}}{1+q^{2n-1}} \right)^2 \tag{3.2.3 i}$$

$$\frac{\theta_4(q)}{\theta_3(q)} = \sqrt{k'} = \prod_{n=1}^{\infty} \left( \frac{1-q^{2n-1}}{1+q^{2n-1}} \right)^2 \tag{3.2.3 ii}$$

且此处 $q = e^{-\pi K'(k)/K(k)}$ (nome)

命题 3.1

定义 $\theta_1^+(q) := \frac{\partial}{\partial z} \theta_1(z, q) \mid_{z=0}$ 对 $|q|<1$ 有

$$\theta_2(q) \theta_3(q) \theta_4(q) = 2 \sum_{m=0}^{\infty} (-1)^m (2m+1) q^{(m+1/2)^2} = \theta_1^+(q) \tag{3.2.4}$$

第二个等式是由 $\theta_1(z, q)$ 定义得到的。

由于 (3.1.14) $\prod_{n=1}^{\infty} (1-q^n)^3 = \sum_{m=0}^{\infty} (-1)^m (2m+1) q^{m(m+1)/2}$

则 $q \to q^2$ 有 $\prod_{n=1}^{\infty} (1-q^{2n})^3 = \sum_{m=0}^{\infty} (-1)^m (2m+1) q^{m(m+1)}$ 两边乘上 $2q^{\frac{1}{4}}$ 有

$$\begin{aligned} \theta_1^+(q) &= 2q^{\frac{1}{4}} Q_0^3 = 2q^{\frac{1}{4}} Q_0^3 (Q_1 Q_2 Q_3)^2 \\ &= (2q^{\frac{1}{4}} Q_0 Q_1^2) (Q_0 Q_2^2) (Q_0 Q_3^2) = \theta_2 \theta_3 \theta_4 \end{aligned}$$

精妙的分配


基于类似的讨论，定义

$$\theta_5(q) = 2 \sum_{n=0}^{\infty} (-1)^n q^{(2n-\frac{1}{2})^2} \tag{3.2.5}$$

$$\theta_6^+(q) = 2 \sum_{n=0}^{\infty} (-1)^{n(n-1)/2} (2n+1) q^{(n+\frac{1}{2})^2} \tag{3.2.6}$$

在 (3.1.9) 中，由于 
$q^{kn^2+ln} = q^{4n^2-2n}$，令 $k=4, \ l=-2$，有

$$\prod_{n=0}^{\infty} (1-q^{8n+6})(1-q^{8n+2})(1-q^{8n+8}) = \sum_{-\infty}^{\infty} (-1)^n q^{4n^2-2n}$$

左式化简，从 $n=1$ 求乘积

$$\prod_{n=1}^{\infty} (1-q^{8n-2})(1-q^{8n-6})(1-q^{8n}) = \prod_{n=1}^{\infty} (1-q^{4n-2})(1-q^{8n})$$

这由因为 $4n-2$ 的数分为 $8n-2$ 与 $8n-6$ 的数。（$4n-2$ 中 $n$ 为奇偶讨论）

又 $\frac{Q_0 Q_1}{Q_2(q^2)} = \frac{\prod (1+q^{2n})(1-q^{2n})}{\prod (1+q^{4n-2})} = \prod_{n=1}^{\infty} (1+q^{4n})(1-q^{2n})$ ($2n$ 数中 分 $4n$ 与 $4n-2$ 的)

$$\begin{aligned} 
\frac{Q_0 Q_1}{Q_2(q^2)} &= \frac{\prod (1+q^{2n})(1-q^{2n})}{\prod (1+q^{4n-2})}\\
&= \prod_{n=1}^{\infty} (1+q^{4n})(1-q^{2n})\\
&= \frac{\prod (1-q^{8n})(1-q^{2n})}{1-q^{4n}}  \\ &= \frac{\prod_{n=1}^{\infty} (1-q^{8n})(1-q^{2n})}{\prod_{n=1}^{\infty} (1+q^{2n})(1-q^{2n})} \\ &= \prod_{n=1}^{\infty} (1-q^{8n}) / \prod_{n=1}^{\infty} (1+q^{2n}) \end{aligned}$$

由 (3.1.4) 欧拉等式中替代 $q \to q^2$，有 $\prod (1-q^{4n-2}) = \frac{1}{\prod (1+q^{2n})}$

则有

$$\prod_{n=0}^{\infty} (1-q^{8n+6})(1-q^{8n+2})(1-q^{8n+8}) = \prod_{n=1}^{\infty} (1-q^{4n-2})(1-q^{8n})$$

$$= \frac{Q_0 Q_1}{Q_2(q^2)} = \sum_{-\infty}^{\infty} (-1)^n q^{4n^2-2n}$$

两边同乘 $2q^{\frac{1}{4}}$，有

$$\theta_5(q) = 2q^{\frac{1}{4}} Q_0 Q_1 / Q_2(q^2)$$

又由 (3.1.5 i)，$Q_0 Q_1 = Q_0(q^2)$， $1/Q_2(q^2) = Q_1(q^2) Q_3(q^2)$

上式为 $2q^{\frac{1}{4}} Q_0(q^2) Q_1(q^2) Q_3(q^2)$

$$\begin{aligned} \theta_2(q^2) \theta_4(q^2) &= 2q^{\frac{1}{2}} Q_0(q^2) Q_1^2(q^2) Q_0(q^2) Q_3^2(q^2) \\ &= 2q^{\frac{1}{2}} Q_0^2(q^2) Q_1^2(q^2) Q_3^2(q^2) \end{aligned}$$


**则有**

$$\theta_5(q) = 2q^{\frac{1}{4}} Q_0 Q_1 / Q_2(q^2) = \sqrt{2} \theta_2^{\frac{1}{2}}(q^2) \theta_4^{\frac{1}{2}}(q^2) \tag{3.2.7}$$

现在讨论 $\theta_6^+(q)$ 吗？ $\theta_6^+ = 2q^{\frac{1}{4}} \sum_{n=0}^{\infty} (-1)^{n(n+1)/2} (2n+1) q^{n^2+n}$

还好不容易找来的论文也没有证明！只是给 $\theta_6^+ = 2q^{\frac{1}{4}} Q_0^3(q^2) Q_2^3(q^2)$

怎么处理 $(-1)^{n(n+1)/2}$ 呢？

**定义** $\eta, f_1, f_2, f$。 令 $\tau = i\sqrt{r} = \sqrt{-r}$

$$\eta = \eta(\sqrt{-r}) = \eta(\tau) := q^{\frac{1}{12}} Q_0 \tag{3.2.9}$$

$$f_1 = f_1(\sqrt{-r}) = f_1(\tau) := q^{-\frac{1}{24}} Q_3 = (4k'^2/k)^{\frac{1}{12}} \tag{3.2.9 ii}$$

$$f_2 = f_2(\sqrt{-r}) = f_2(\tau) := 2^{\frac{1}{2}} q^{\frac{1}{12}} Q_1 = (4k^2/k')^{\frac{1}{12}} \tag{3.2.9 iii}$$

$$f = f(\sqrt{-r}) = f(\tau) := q^{-\frac{1}{24}} Q_2 = (\frac{4}{kk'})^{\frac{1}{12}} \tag{3.2.9 iv}$$

**先验证** $q^{-\frac{1}{24}} Q_3 = (4k'^2/k)^{\frac{1}{12}}$ 吧， 即 $q^{-\frac{1}{2}} Q_3^{12} = 4k'^2/k$

由于 $k' = \frac{\theta_4^2}{\theta_3^2}, \quad k = \frac{\theta_2^2}{\theta_3^2} \quad \text{则} \quad 4 \frac{k'^2}{k} = 4 \frac{\theta_4^4}{\theta_3^2 \theta_2^2}$

由 引理 3.1 $\theta_4^4 = Q_0^4 Q_3^8, \quad \theta_3^2 = Q_0^2 Q_2^4, \quad \theta_2^2 = 4q^{\frac{1}{2}} Q_0^2 Q_1^4$

$$\therefore 4 \frac{\theta_4^4}{\theta_3^2 \theta_2^2} = 4 \frac{Q_0^4 Q_3^8}{Q_0^2 Q_2^4 \cdot 4q^{\frac{1}{2}} Q_0^2 Q_1^4} = q^{-\frac{1}{2}} \frac{Q_3^8}{Q_2^4 Q_1^4} = q^{-\frac{1}{2}} Q_3^{12}$$

因为 $Q_1 Q_2 Q_3 = 1$

**再验证** $(4k^2/k')^{\frac{1}{12}} = 2^{\frac{1}{2}} q^{\frac{1}{12}} Q_1$ 即 $4k^2/k' = 2^6 q Q_1^{12}$

$$4 \frac{k^2}{k'} = 4 \frac{\theta_2^4/\theta_3^4}{\theta_4^2/\theta_3^2} = 4 \frac{\theta_2^4}{\theta_3^2 \theta_4^2} = 4 \frac{2^4 q Q_0^4 Q_1^8}{Q_0^2 Q_2^4 Q_0^2 Q_3^4} = q 2^6 \frac{Q_1^8}{Q_2^4 Q_3^4} = 2^6 q Q_1^{12}$$

**最后** $(4/kk')^{\frac{1}{12}} = q^{-\frac{1}{24}} Q_2$ 即 $\frac{4}{kk'} = q^{-\frac{1}{2}} Q_2^{12}$

$$\frac{4}{kk'} = 4 \frac{\theta_3^4}{\theta_4^2 \theta_2^2} = 4 \frac{Q_0^4 Q_2^8}{Q_0^2 Q_3^4 \cdot 4q^{\frac{1}{2}} Q_0^2 Q_1^4} = q^{-\frac{1}{2}} \frac{Q_2^8}{Q_3^4 Q_1^4} = q^{-\frac{1}{2}} Q_2^{12}$$



由此，可得 $f, f_1, f_2$ 之间的关系式。

由于 $f^{12} = \frac{4}{kk'}, \quad f_1^{12} = \frac{4k'^2}{k}, \quad f_2^{12} = \frac{4k^2}{k'}$。

则 $k'^3 f^{12} = \frac{4k'^2}{k}, \quad k^3 f^{12} = \frac{4k^2}{k'}$。

有

$$k' f^4 = f_1^4, \quad k f^4 = f_2^4$$

由于 $Q_1 Q_2 Q_3 = 1$，有

$$f f_1 f_2 = \sqrt{2} \tag{3.2.10 i}$$

又 $Q_2^8 = Q_3^8 + 16q Q_1^8$



$$f^8 = f_1^8 + f_2^8 \tag{3.2.10 ii}$$

由于 $K = \frac{\pi}{2} \theta_3^2, \quad \eta^2 f^4 = q^{\frac{1}{6}} Q_0^2 q^{-\frac{1}{6}} Q_2^4 = \theta_3^2(q)$

则

$$K = \frac{\pi}{2} \eta^2 f^4 = \frac{\pi}{2k} \eta^2 f_1^4 = \frac{\pi}{2k'} \eta^2 f_2^4 \tag{3.2.11}$$

这提供了一个计算 $\eta^2$，或说 $Q_0$ 的方法 ($f, f_1, f_2$ 可由模数 $k$ 算)。

**由 (3.2.9 iv) 导出的重要公式是**

$$\sum_{n,m=-\infty}^{\infty \prime} \frac{(-1)^{m+n}}{m^2+r n^2} = \frac{-4\pi}{\sqrt{r}} \log f(\sqrt{-r}) = \frac{\pi}{3\sqrt{r}} \log \left( \frac{kk'}{4} \right) \tag{3.2.12}$$

$\sum'$ 表示求和在一个不断扩大侧长方形内求和，且去掉 $m=n=0$ 这项。（双重级数）。即 $\sum' = \lim_{N,M \to \infty}$ (像限侧的二重部分和)

见教程 [594] 目。但这里，由于 $\sum_{m,n} \frac{(-1)^{m+n}}{m^2+rn^2}$ 是收敛的

而 $\sum_{m=-\infty}^{\infty} \frac{(-1)^{m+n}}{m^2+rn^2}$ 对 $n = \pm 1, \pm 2, \dots$ 都收敛，可以理解为

$$\sum_{m,n=-\infty}^{\infty \prime} = \sum_{n=1}^{\infty} \sum_{m=-\infty}^{\infty} + \sum_{n=-\infty}^{-1} \sum_{m=-\infty}^{\infty} + \sum_{n=0} \left( \sum_{m=1}^{\infty} + \sum_{m=-\infty}^{-1} \right)$$

_(注：箭头指向上式括号部分，标注“才把项 $n=0$ 归入”)_

**证明 (3.2.12) 的方法是对 $\log Q_2$ 作展开。**

$$-\frac{2\pi}{\sqrt{r}} \log Q_2 = \frac{-2\pi}{\sqrt{r}} \sum_{n=0}^{\infty} \log(1+q^{2n+1}), \quad \text{由于 } \log(1+x) = \sum_{k=1}^{\infty} \frac{(-1)^{k-1}}{k} x^k$$


有 $-\frac{2\pi}{\sqrt{r}} \sum_{n=0}^{\infty} \sum_{k=1}^{\infty} \frac{(-1)^{k-1}}{k} q^{(2n+1)k}$，交换求和 $\frac{-2\pi}{\sqrt{r}} \sum_{k=1}^{\infty} \frac{(-1)^{k}}{k} \sum_{n=0}^{\infty} q^{(2n+1)k}$

内层是一个等比数列求和： $\sum_{n=0}^{\infty} q^{(2n+1)k} = q^k \sum_{n=0}^{\infty} (q^{2k})^n$

$$= q^k \frac{1}{1-q^{2k}} = \frac{1}{q^{-k}-q^k}$$

由于 $q = e^{-\pi\sqrt{r}}$，上式为 $\frac{1}{e^{\pi\sqrt{r}k} - e^{-\pi\sqrt{r}k}} = \frac{1}{2} \text{cosech}(\pi\sqrt{r}k)$

$$\text{则} \quad \frac{\pi}{\sqrt{r}} \sum_{k=1}^{\infty} \sum_{n=0}^{\infty} \frac{(-1)^k}{k} 2 q^{(2n+1)k} = \pi \sum_{k=1}^{\infty} \frac{(-1)^k}{\sqrt{r}k} \text{cosech}(\pi\sqrt{r}k)$$

由于 $\pi \text{cosech}(\pi x) = \frac{1}{x} + 2x \sum_{m=1}^{\infty} \frac{(-1)^m}{m^2+x^2} = x \sum_{m=-\infty}^{\infty} \frac{(-1)^m}{m^2+x^2}$

$$\pi \text{cosech}(\pi\sqrt{r}k) = \sqrt{r}k \sum_{m=-\infty}^{\infty} \frac{(-1)^m}{rk^2+m^2}$$

$$\therefore \quad \pi \sum_{k=1}^{\infty} \frac{(-1)^k}{\sqrt{r}k} \text{cosech}(\pi\sqrt{r}k) = \sum_{k=1}^{\infty} \sum_{m=-\infty}^{\infty} \frac{(-1)^{k+m}}{m^2+rk^2}$$

$$= \sum_{k=1}^{\infty} \sum_{m=-\infty}^{\infty} \frac{(-1)^{k+m}}{m^2+rk^2} = \sum_{k=-\infty}^{-1} \sum_{m=-\infty}^{\infty} \frac{(-1)^{k+m}}{m^2+rk^2}$$

由于 $\sum_{n=0}^{\infty} (\sum_{m=1}^{\infty} + \sum_{m=-\infty}^{-1}) = \sum_{m=1}^{\infty} \frac{(-1)^m}{m^2} + \sum_{m=-\infty}^{-1} \frac{(-1)^m}{m^2}$

$$= 2 \sum_{m=1}^{\infty} \frac{(-1)^{m-1}}{m^2} = -2 \frac{\pi^2}{12} = -\frac{\pi^2}{6}$$

$$\text{则从}  - \frac{2\pi}{\sqrt{r}} \log Q_2 = \sum_{k=1}^{\infty} \sum_{m=-\infty}^{\infty} \frac{(-1)^{k+m}}{m^2+rk^2}$$

$$\sum_{m,n=-\infty}^{\infty \prime} \frac{(-1)^{m+n}}{m^2+rn^2} = \frac{-4\pi}{\sqrt{r}} \log Q_2 - \frac{\pi^2}{6} = \frac{-4\pi}{\sqrt{r}} (\log Q_2 + \frac{\pi}{24}\sqrt{r}) \quad (*)$$

又 $\log(f(\sqrt{-r})) = -\frac{1}{24} \log q + \log Q_2 = \frac{\pi}{24}\sqrt{r} + \log Q_2 \quad (q = e^{-\pi\sqrt{r}})$

$$\therefore \quad = \frac{1}{12} \log \frac{4}{kk'}, \quad \text{两边乘 } \frac{-4\pi}{\sqrt{r}} \text{ 就有 (3.2.12) 式}$$

当然要对 (3.2.12) 赋点值 $r=1$。 $r=1$ 时 $s=1$。 则 $q=e^{-\pi}$

$k=k'=\frac{1}{\sqrt{2}}$。

$\frac{\pi}{3\sqrt{1}} \log \frac{kk'}{4} = \frac{\pi}{3} \log \frac{1}{8} = -\pi \log 2$

$$\sum_{m,n=-\infty}^{\infty \prime} \frac{(-1)^{m+n}}{m^2+n^2} = -\pi \log 2$$


又 $\Sigma'$ 这和可分为“在轴点”和“非轴点”。

在轴点为 $\sum_{n=-\infty, n \ne 0}^{\infty} \frac{(-1)^n}{n^2} = 2 \sum_{n=1}^{\infty} \frac{(-1)^n}{n^2} = -\frac{\pi^2}{6}$

$$\sum_{m=-\infty, m \ne 0}^{\infty} \frac{(-1)^m}{m^2} = -\frac{\pi^2}{6}$$

非轴点和为 $\sum_{m=1}^{\infty} \sum_{n=1}^{\infty} \frac{(-1)^{m+n}}{m^2+n^2}$ + 其余三象限。由对称性为

$$4 \sum_{m=1}^{\infty} \sum_{n=1}^{\infty} \frac{(-1)^{m+n}}{m^2+n^2}$$

则有

$$\sum_{m=1}^{\infty} \sum_{n=1}^{\infty} \frac{(-1)^{m+n}}{m^2+n^2} = \frac{\pi^2}{12} - \frac{\pi}{4}\log 2$$

**现研究拉马努金研究过的数列：**

$$G_n := (2kk')^{-\frac{1}{12}} = 2^{-\frac{1}{4}} f(\sqrt{-n}) \tag{3.2.13}$$

$$g_n := (\frac{k'^2}{2k})^{\frac{1}{12}} = 2^{-\frac{1}{4}} f_1(\sqrt{-n})$$

一个美妙的结果 $G_{25} = \frac{\sqrt{5}+1}{2}$ , $g_{10} = \sqrt{\frac{\sqrt{5}+1}{2}}$

记 $k(q^n) = \delta$ , $K(\delta) = K(k(q^n)) = \Lambda$

由于 $k = \frac{\theta_2^2}{\theta_3^2}$ , $k' = \frac{\theta_4^2}{\theta_3^2}$ , $K = \frac{\pi}{2} \theta_3^2$ , $\frac{2K}{\pi} = \theta_3^2$

则 $kk' (\frac{2K}{\pi})^3 = \frac{\theta_2^2 \theta_4^2}{\theta_3^4} \theta_3^6 = \theta_2^2 \theta_4^2 \theta_3^2 = 2^2 q^{\frac{1}{2}} Q_0^2 Q_1^4 Q_0^2 Q_3^4 Q_0^2 Q_2^4$

$$= 4 \sqrt{q} Q_0^6 Q_1^4 Q_2^4 Q_3^4 = 4\sqrt{q} Q_0^6$$

**有**

$$kk' \left(\frac{2K}{\pi}\right)^3 = 4\sqrt{q} Q_0^6 \tag{3.2.14}$$

亦为计算 $Q_0$ 的一个式子。变量 $q$ 换为 $q^n$ 有 $\delta \delta' (\frac{2\Lambda}{\pi})^3 = 4 q^{\frac{n}{2}} Q_0^6(q^n)$

此式与 (3.2.14) 作商 $\frac{kk'}{\delta \delta'} (\frac{2K}{2\Lambda})^3 = \frac{q^{\frac{1}{2}} Q_0^6}{q^{\frac{n}{2}} Q_0^6(q^n)}$ 即

$$\left(\frac{kk'}{\delta \delta'}\right)^{\frac{1}{6}} \sqrt{\frac{K}{\Lambda}} = \frac{q^{\frac{1}{12}} Q_0}{q^{\frac{n}{12}} Q_0(q^n)} \tag{3.2.15}$$

We also have

$$\left(\frac{2K}{\pi}\right)^2 (1-2k^2) = 1 - 24 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}} \tag{3.2.16}$$

$$\left(\frac{2K}{\pi}\right)^4 (1-k^2 k'^2) = 1 + 240 \sum_{n=1}^{\infty} \frac{n^3 q^{2n}}{1-q^{2n}} \tag{3.2.17}$$

$$\left(\frac{2K}{\pi}\right)^6 (1-2k^2)(1+\frac{1}{2} k^2 k'^2) = 1 - 504 \sum_{n=1}^{\infty} \frac{n^5 q^{2n}}{1-q^{2n}} \tag{3.2.18}$$

先证 (3.2.16) 吧。剩下又当习题了。先引入 1 个 引理 与 3 个 命题。

引理 3.1 Lemma 3.1

对 $|q|<1$

$$\sum_{n=0}^{\infty} \frac{n q^n}{1+q^n} = \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}}$$

_(注：左边级数求和通常从 $n=1$ 有意义，但 $n=0$ 时项为 0，故写 0 也无妨)_

**Proof 证明：** 由 (3.1.4) $\prod_{n=1}^{\infty} (1+q^n) \prod_{n=1}^{\infty} (1-q^{2n-1}) = 1$。 取对数后

$$\sum_{n=1}^{\infty} \log(1+q^n) = - \sum_{n=1}^{\infty} \log(1-q^{2n-1})$$

两边对 $q$ 求导，

$$\sum_{n=1}^{\infty} \frac{n q^{n-1}}{1+q^n} = + \sum_{n=1}^{\infty} \frac{(2n-1) q^{2n-2}}{1-q^{2n-1}}$$

两边同乘 $q$ 和 从 $n=0$ 或 1 开始求和得证。

命题 3.2

对 $|q|<1$

$$\theta_3^4(q) = 1 + 8 \sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} + 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}} \tag{3.2.20}$$

$$\theta_2^4(q) = 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}} + 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}} \tag{3.2.21}$$

$$\theta_4^4(q) = 1 + 8 \sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} - 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}} \tag{3.2.22}$$

**Proof** 由 (2.3.6)
$$\frac{\pi}{4} \theta_3^4 = \left(\frac{d}{ds} \theta_4\right)/\theta_4 - \left(\frac{d}{ds} \theta_2\right)/\theta_2$$

而 $\dfrac{d\theta}{ds} = \dfrac{d\theta}{dq} \dfrac{dq}{ds} = \dfrac{d\theta}{dq} (-\pi q) \quad (q = e^{-\pi s})$


(2.3.16) 变为 
$$\frac{\pi}{4} \theta_3^4 = (\frac{1}{\theta_4} \frac{d}{ds} \theta_4 - \frac{1}{\theta_2} \frac{d}{ds} \theta_2) (-\pi q)$$

**即**

$$\theta_3^4(q) = -4q (\frac{1}{\theta_4} \frac{d\theta_4}{dq} - \frac{1}{\theta_2} \frac{d\theta_2}{dq})$$

$$= -4q \left[ \frac{d}{dq} \ln \left( \frac{\theta_4}{\theta_2} \right) \right]$$

而 

$$\frac{\theta_4}{\theta_2} = \frac{1}{2q^{1/4}} \frac{Q_3^2}{Q_1^2}, \quad -\ln \frac{\theta_4}{\theta_2} = \ln 2 + \frac{1}{4} \ln q + 2 \ln \frac{Q_1}{Q_3}$$

$$\therefore \quad -4q \frac{d}{dq} \ln (\frac{\theta_4}{\theta_2}) = +4q \left( \frac{1}{4} \frac{1}{q} + 2 \frac{d}{dq} \log \frac{Q_1}{Q_3} \right)$$

$$= 8q \frac{d}{dq} \log \frac{Q_1}{Q_3} + 1$$

像 Lemma 3.1 那种 $\frac{d}{dq} (\log Q_1 - \log Q_3) = \frac{d}{dq} \left( \sum_{n=1}^{\infty} \log(1+q^{2n}) - \sum_{n=1}^{\infty} \log(1-q^{2n-1}) \right)$

$$= \sum_{n=1}^{\infty} \frac{2n q^{2n-1}}{1+q^{2n}} + \sum_{n=1}^{\infty} \frac{(2n-1) q^{2n-2}}{1-q^{2n-1}}, \quad \text{代入上式即得 (3.2.20)}$$

**对于 (3.2.21)**，也是由 (2.3.14) 类似得 $\frac{\pi}{4} \theta_2^4 = (\frac{1}{\theta_4} \frac{d}{ds} \theta_4 - \frac{1}{\theta_3} \frac{d}{ds} \theta_3)$

$$\theta_2^4 = -4q \left( \frac{1}{\theta_4} \frac{d\theta_4}{dq} - \frac{1}{\theta_3} \frac{d\theta_3}{dq} \right)$$

$$= -4q \left( \frac{d}{dq} \ln (\frac{\theta_4}{\theta_3}) \right) = 4q \frac{d}{dq} \ln \frac{\theta_3}{\theta_4} $$

$$\frac{\theta_3}{\theta_4} =  \frac{Q_2^2}{Q_3^2}, \quad \ln \frac{\theta_3}{\theta_4} = 2 \ln \frac{Q_2}{Q_3}$$

$$\frac{d}{dq} \ln \frac{\theta_3}{\theta_4} =  2 \frac{d}{dq} \ln \frac{Q_1}{Q_3} = 2 \sum_{n=1}^{\infty} \frac{2n q^{2n-1}}{1+q^{2n}} + 2 \sum_{n=1}^{\infty} \frac{(2n-1) q^{2n-2}}{1-q^{2n-1}} $$



$$= 2 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n}}{1+q^{2n+1}} + 2 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n}}{1-q^{2n+1}} $$

乘上 $4q$ 有

$$\theta_2^4(q) = 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}} + 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}}$$


对于 (3.2.22)
$$\begin{aligned}\frac{\pi}{4} \theta_4^4 = \frac{1}{\theta_3} \frac{d\theta_3}{ds} - \frac{1}{\theta_2} \frac{d\theta_2}{ds}\\
= -\pi q (\frac{1}{\theta_3} \frac{d\theta_3}{dq} - \frac{1}{\theta_2} \frac{d\theta_2}{dq})
\end{aligned}
$$

$$\theta_4^4 = -4q (\frac{1}{\theta_3} \frac{d\theta_3}{dq} - \frac{1}{\theta_2} \frac{d\theta_2}{dq}) = +4q \frac{d}{dq} \ln \frac{\theta_2}{\theta_3}$$

$$\frac{\theta_2}{\theta_3} = 2q^{\frac{1}{4}} \left(\frac{Q_1}{Q_2}\right)^2, \quad \ln \frac{\theta_2}{\theta_3} = \ln 2 + \frac{1}{4} \ln q + 2 \ln \frac{Q_1}{Q_2}$$

$$\frac{d}{dq} \ln \frac{\theta_2}{\theta_3} = \frac{1}{4q} + 2 \sum_{n=1}^{\infty} \frac{2n q^{2n-1}}{1+q^{2n}} - 2 \sum_{n=1}^{\infty} \frac{(2n-1) q^{2n-2}}{1+q^{2n-1}}$$
$$\therefore \quad \theta_4^4 = 1 + 8 \sum_{n=1}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} - 8 \sum_{n=1}^{\infty} \frac{(2n-1) q^{2n-1}}{1+q^{2n-1}}$$

$$= 1 + 8 \sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} - 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}}$$

定理 3.2

对 $|q|<1$

$$\theta_3^4(q) = 1 + 8 \sum_{\substack{n \ne 0 (\text{mod } 4) \\ n \ge 1}} \frac{n q^n}{1-q^n} \tag{3.2.23}$$

$$ \theta_4^4(q) - \theta_2^4(q) = 1 - 24 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}} \tag{3.2.24}$$

**Proof.** (3.2.23) 由 (3.2.20) 与 (3.2.19) 有 （

$$\sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} = \sum_{n=0}^{\infty} \frac{2(2n+1) q^{4n+2}}{1-q^{4n+2}} = \sum_{n=0}^{\infty} \frac{(4n+2) q^{4n+2}}{1-q^{4n+2}}$$

$$\therefore \quad \theta_3^4(q) = 1 + 8 \sum_{n=0}^{\infty} \frac{(4n+2) q^{4n+2}}{1-q^{4n+2}} + 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}}$$


由于 $2n+1, \ 4n+2$ 跑遍不被 4 整除的数 ($n \ne 0, \text{mod } 4$)，则

得 (3.2.23) 式。

**现证** (3.2.24) 在 命题 3.2 里作差 是

$$\begin{aligned}
\theta_4^4 - \theta_2^4& = 1 + 8 \sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} - 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}}\\
&- 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}} - 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}}\\
&= 1 - 16 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}} + 8 \sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} - 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}}
\end{aligned}
$$


在 Lemma 3.1 代替 $q \to -q$

$$\sum_{n=0}^{\infty} \frac{n(-1)^n q^n}{1+(-1)^n q^n} = \sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} - \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}}=-\sum_{n=0}^\infty\frac{(2n+1)q^{2n+1}}{1+q^{2n+1}}$$



$$\therefore \quad 8 \sum_{n=0}^{\infty} \frac{2n q^{2n}}{1+q^{2n}} - 8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1-q^{2n+1}} = -8 \sum_{n=0}^{\infty} \frac{(2n+1) q^{2n+1}}{1+q^{2n+1}}$$

代入得 (3.2.24)。

由 (3.2.24) 立得 (3.2.16)。因为 $\theta_3^4 = \theta_4^4 + \theta_2^4$ (2.1.10)

$$\theta_4^4 - \theta_2^4 = \theta_3^4 - 2\theta_2^4 = \theta_3^4 \left( 1 - 2\frac{\theta_2^4}{\theta_3^4} \right) = \theta_3^4 (1-2k^2)$$

$$= \left(\frac{2K}{\pi}\right)^2 (1-2k^2)$$

(3.2.17) 类似，但又先得

$$\theta_3^8(-q) = \theta_4^8(q) = 1 + 16 \sum_{n=1}^{\infty} \frac{(-1)^n n^3 q^n}{1-q^n} \tag{3.2.25}$$

(3.2.18) 需要

$$\theta_3^{12}(q) = 1 + 8 \sum_{n=1}^{\infty} \frac{n^5 q^n}{1-q^{2n}} - 8 \sum_{n=1}^{\infty} \frac{(-1)^n n^5 q^{2n}}{1-q^{2n}} + (\theta_1^+)^4 \tag{3.2.26}$$

上面两个式子已知超出本书了。
