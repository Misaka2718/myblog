---
title: 2.5两个计算圆周率的方法
createTime: 2026/01/18 17:54:30
permalink: /pi-agm/ch2/2.5
---


## 算法 2.1

令 $x_0 = \sqrt{2}, \quad \pi_0 = 2+\sqrt{2}, \quad y_1 = 2^{\frac{1}{4}}$。 定义

$$\begin{aligned}
&(i) \quad x_{n+1} = \frac{1}{2} (\sqrt{x_n} + \frac{1}{\sqrt{x_n}}) \quad n \ge 0\\

&(ii) \quad y_{n+1} = \frac{y_n \sqrt{x_n} + 1/\sqrt{x_n}}{y_n + 1} \quad n \ge 1\\

&(iii) \quad \pi_n = \pi_{n-1} \frac{x_{n+1}}{y_{n+1}} \quad n \ge 1 \quad \\ &\text{且 } \lim_{n \to \infty} \pi_n = \pi_0\prod_{n=1}^\infty\frac{1+x_n}{1+y_n}\\
\end{aligned}
$$

然后 $\pi_n$ 单调递减 收敛到 $\pi$，且还有

$$ \quad \frac{3}{2}(y_{n+1}-x_{n+1}) \le \pi_n - \pi \le \frac{7}{4}(y_{n+1}-x_{n+1}) \tag{2.5.1}$$

$$ \quad \pi_{n+1} - \pi \le \frac{1}{10} (\pi_n - \pi)^2 \tag{2.5.2}$$

对 $n \ge 2$

$$\quad \pi_n - \pi < 10^{-2^{n+1}} \tag{2.5.3}$$

**Proof:** 定义 $\pi_n = \dfrac{2\sqrt{2} b_{n+1}^2 a_{n+1}}{\dot{a}_{n+1}}$ （其中 $a_0=1, b_0=1/\sqrt{2}$）。

由于 $\pi = 2\sqrt{2} \frac{M^3(1, 1/\sqrt{2})}{\dot{M}(1, 1/\sqrt{2})}$，则

$$\pi_n \to \pi \quad (n \to \infty)$$

又

$$\begin{aligned} \frac{\pi_n}{\pi_{n-1}} &= \frac{(b_{n+1}/b_n)^2 (a_{n+1}/a_n)}{\dot{a}_{n+1}/\dot{a}_n} = \frac{b_{n+1}^2}{b_n^2} \frac{a_{n+1}}{a_n} \frac{\dot{a}_n}{\dot{a}_{n+1}} \\ &= \frac{a_n b_n}{b_n^2} \frac{\frac{a_n+b_n}{2}}{a_n} \frac{\dot{a}_n}{\frac{\dot{a}_n+\dot{b}_n}{2}}  \\ &= \frac{\dot{a}_n}{b_n} \frac{a_n+b_n}{\dot{a}_n+\dot{b}_n} = \frac{1+x_n}{1+y_n} \end{aligned}$$

_(注：此处倒数第二步推导实际上为 $\frac{\dot{a}_n(a_n+b_n)}{b_n(\dot{a}_n+\dot{b}_n)} = \frac{a_n+b_n}{b_n} / \frac{\dot{a}_n+\dot{b}_n}{\dot{a}_n}$)_

则 $\pi_n = \pi_{n-1} \frac{2\sqrt{2} b_{n+1}^2 a_{n+1}}{\dot{a}_{n+1}}$ 正符合 (iii) 式。

$$\begin{aligned} \pi_0 &= \frac{2\sqrt{2} b_1^2 a_1}{\dot{a}_1} = 2\sqrt{2} \frac{a_0 b_0 (a_0+b_0)/2}{\frac{\dot{a}_0+\dot{b}_0}{2}} \\ &= 2\sqrt{2} \frac{\frac{1}{\sqrt{2}}(1+\frac{1}{\sqrt{2}})}{1} \\ &= 2(1+\frac{1}{\sqrt{2}}) = 2+\sqrt{2} \end{aligned}$$


由于 $y_n \ge x_n \ge 1$，则 $\frac{1+x_n}{1+y_n} \le 1$，$\pi_n$ 单调递减。

现在研究 $\pi_n$ 收敛到 $\pi$ 的速度。先看 $y_{n+1} - x_{n+1}$。

$$\begin{aligned} y_{n+1} - x_{n+1} &= \frac{y_n\sqrt{x_n} + 1/\sqrt{x_n}}{1+y_n} - \frac{\sqrt{x_n} + 1/\sqrt{x_n}}{2} \\ &= \frac{2y_nx_n + 2/\sqrt{x_n}\cdot\sqrt{x_n} - (\sqrt{x_n} + 1/\sqrt{x_n})(1+y_n)\sqrt{x_n}}{2\sqrt{x_n}(1+y_n)} \\ &= \frac{2y_nx_n + 2 - (x_n+1)(1+y_n)}{2\sqrt{x_n}(1+y_n)} \\ &= \frac{2y_nx_n + 2 - (x_n + x_ny_n + 1 + y_n)}{2\sqrt{x_n}(1+y_n)} \\ &= \frac{y_nx_n + 1 - x_n - y_n}{2\sqrt{x_n}(1+y_n)} = \frac{(y_n-1)(x_n-1)}{2\sqrt{x_n}(1+y_n)} \end{aligned}$$

又 $1 \le x_n \le y_n$， $x_n - 1 \le y_n - 1$。

则 $(y_n-1)(x_n-1) \le (y_n-1)^2$。

又 $2\sqrt{x_n}(1+y_n) \ge 2 \cdot 2 = 4$。

则 $y_{n+1} - x_{n+1} \le \frac{1}{4} (y_n-1)^2$。

**当**

$$\frac{x_n-1}{y_n-1} < 2-\sqrt{3} \quad \tag{A}$$

**成立时，看比**

$$\frac{(y_n-1)(x_n-1)}{(y_n-x_n)^2} \frac{1}{2\sqrt{x_n}(1+y_n)}$$

令 $r = \frac{x_n-1}{y_n-1}$，则 $x_n-1 = r(y_n-1)$，

$y_n - x_n = y_n - 1 - (x_n - 1) = (y_n - 1)(1 - r)$。

$$\therefore \quad \frac{(y_n-1)(x_n-1)}{(y_n-x_n)^2} = \frac{r(y_n-1)^2}{(y_n-1)^2(1-r)^2} = \frac{r}{(1-r)^2}$$

令 $f(r) = \frac{r}{(1-r)^2}$，则 $f'(r) = \frac{(1-r)^2 - r \cdot 2(1-r)(-1)}{(1-r)^4} = \frac{1+r}{(1-r)^3}$。

解 $f'(r)=0$ 得 $r=1$ 。$f(r)$ 在 $r<1$ 时 $f'(r)>0$，$f(r)$ 单调增。

又 $r = \frac{x_n-1}{y_n-1} < 2-\sqrt{3}$ 时， $f(r) < f(2-\sqrt{3}) = \frac{2-\sqrt{3}}{(\sqrt{3}-1)^2} = \frac{1}{2}$。

$$\therefore \quad \frac{(y_n-1)(x_n-1)}{(y_n-x_n)^2} < \frac{1}{2}, \quad \text{当 } \frac{x_n-1}{y_n-1} < 2-\sqrt{3}$$

**即当 (A) 成立时有** 

$$\tag{2.5.4} \quad y_{n+1} - x_{n+1} = \frac{(y_n-1)(x_n-1)}{2\sqrt{x_n}(1+y_n)} \le \frac{1}{8} (y_n-x_n)^2, $$

( 可以证明 $r_n = \frac{x_{n-1}}{y_{n-1}} < 2-\sqrt{3}$ 对 $n \ge 1$ 是成立的 )

当下 考虑 $\pi_n - \pi_{n+1}$

$$\pi_n - \pi_{n+1} = \pi_n - \pi_n \frac{1+x_{n+1}}{1+y_{n+1}} = \pi_n \left( 1 - \frac{1+x_{n+1}}{1+y_{n+1}} \right) = \pi_n \frac{y_{n+1}-x_{n+1}}{y_{n+1}+1}$$

有

$$\quad \pi_n - \pi_{n+1} = \frac{\pi_n(y_{n+1}-x_{n+1})}{y_{n+1}+1} \tag{2.5.5}$$

因此

$$\frac{\pi_n}{y_{n+1}+1} (y_{n+1}-x_{n+1}) = \pi_n - \pi_{n+1} \le \frac{\pi_n}{2} (y_{n+1}-x_{n+1})$$

则

$$\pi_n - \pi_{n+1} < \frac{\pi_n}{2} (y_{n+1}-x_{n+1})$$

$$\pi_{n+1} - \pi_{n+2} < \frac{\pi_{n+1}}{2} (y_{n+2}-x_{n+2})$$

$$\dots$$

$$\pi_{n+k-1} - \pi_{n+k} \le \frac{\pi_{n+k-1}}{2} (y_{n+k}-x_{n+k})$$

将上式累加有

$$\pi_n - \pi_{n+k} \le \frac{\pi_n}{2} (y_{n+1}-x_{n+1}) + \dots + \frac{\pi_{n+k-1}}{2} (y_{n+k}-x_{n+k})$$

由于 $\pi_n$ 递减 $\pi_{n+k-1} \le \pi_n$

$$\pi_n - \pi_{n+k}\le \frac{\pi_n}{2} \sum_{i=1}^k (y_{n+i} - x_{n+i})$$

令 $k \to \infty$，有

$$\pi_n - \pi \le \frac{\pi_n}{2} \sum_{i=1}^{\infty} (y_{n+i} - x_{n+i}) = \frac{\pi_n}{2} \sum_{k=1}^{\infty} (y_{n+k} - x_{n+k})$$

又

$$y_{n+1} - x_{n+1} = y_{n+1} - x_{n+1}$$

$$y_{n+2} - x_{n+2} \le \frac{1}{8} (y_{n+1} - x_{n+1})^2$$

$$y_{n+3} - x_{n+3} \le \frac{1}{8} (y_{n+2} - x_{n+2})^2 \le \frac{1}{8} \frac{1}{8^2} (y_{n+1} - x_{n+1})^4 \le \frac{1}{8^3} (y_{n+1} - x_{n+1})^3$$

_(注：此处最后一项指数放缩为3，是为了凑几何级数)_

总之 $y_{n+k} - x_{n+k} \le \frac{1}{8^{k-1}} (y_{n+1} - x_{n+1})^{k-1}$ 

(注：笔记作者划掉了这一行，并在下方修正)

(2.5.4) 放太小了，改成 $y_{n+1} - x_{n+1} \le \frac{1}{8} (y_n - x_n)$ 够多。

$$y_{n+4} - x_{n+4} \le \frac{1}{8} (y_{n+3} - x_{n+3})^2 \le \frac{1}{8} \frac{1}{8^6} (y_{n+1} - x_{n+1})^6 \le \frac{1}{8^4} (y_{n+1} - x_{n+1})^4$$

$$\therefore \quad \sum_{k=1}^{\infty} (y_{n+k} - x_{n+k}) \le (y_{n+1} - x_{n+1}) + \frac{1}{8} (y_{n+1} - x_{n+1})^2 + \frac{1}{8^2} (y_{n+1} - x_{n+1})^3 + \dots$$

$$\le \frac{y_{n+1} - x_{n+1}}{1 - \frac{1}{8}(y_{n+1}-x_{n+1})}$$

$$\therefore \quad \pi_n - \pi \le \frac{\pi_n}{2} \sum_{k=1}^{\infty} (y_{n+k} - x_{n+k}) \le \frac{\pi_n}{2} \frac{y_{n+1}-x_{n+1}}{1 - \frac{1}{8}(y_{n+1}-x_{n+1})}$$


又由 (2.5.5) 与 $\pi_n$ 的单减性，得 $\pi_n - \pi$ 的下界

$$\begin{aligned} \pi_n - \pi &= \pi_{n+1} - \pi + \frac{\pi_n}{y_{n+1}+1} (y_{n+1} - x_{n+1}) \\ &\ge \frac{\pi}{y_{n+1}+1} (y_{n+1} - x_{n+1}) \end{aligned}$$

由于 $y_n$ 收敛，则其有界，作者检测了一个 $y_{n+1}$ 的界（数值上）。

对 $n > 0$，得 $y_{n+1} + 1 < \frac{2\pi}{3}$，有

$$\pi_n - \pi \ge \frac{3}{2}(y_{n+1} - x_{n+1})$$

又 检验了 $\frac{\pi_n}{2} \frac{1}{1-\frac{1}{8}(y_{n+1}-x_{n+1})} \le \frac{7}{4}$ 则

$$\quad \frac{3}{2}(y_{n+1}-x_{n+1}) \le \pi_n - \pi \le \frac{7}{4} (y_{n+1}-x_{n+1}) \tag{2.5.6}$$

用上 (2.5.4) ($y_{n+2}-x_{n+2} \le \frac{1}{8}(y_{n+1}-x_{n+1})^2$) 和 (2.5.6)

$$\begin{aligned} \pi_{n+1} - \pi &\le \frac{7}{4} (y_{n+2} - x_{n+2}) \le \frac{7}{4} \cdot \frac{1}{8} (y_{n+1}-x_{n+1})^2 \\ &\le \frac{7}{32} \left( \frac{2}{3} (\pi_n - \pi) \right)^2 \quad \text{(由 2.5.6 左边得)} \\ &= \frac{7}{72} (\pi_n - \pi)^2 \\ &\le \frac{1}{10} (\pi_n - \pi)^2 \end{aligned}$$

此即 (2.5.2)，也由此得 (2.5.3)。

$$\pi_n - \pi \le \frac{1}{10} (\pi_{n-1} - \pi)^2 \le \frac{1}{10} \frac{1}{10^2} (\pi_{n-2} - \pi)^4 \le \dots$$

_(注：此处笔记展示了递归放缩的过程)_

对 $n \ge 2$， $\pi_n - \pi \le 10^{-2^{n+1}}$

数值验证 $\pi_2 - \pi \le 10^{-2^3}$ 成立。

若 $\pi_n - \pi < 10^{-2^{n+1}}$ 成立，则

$$\begin{aligned} \pi_{n+1} - \pi &\le \frac{1}{10} (\pi_n - \pi)^2 \\ &\le \frac{1}{10} (10^{-2^{n+1}})^2 \\ &= \frac{1}{10} 10^{-2^{n+1} \cdot 2} \\ &= 10^{-1} 10^{-2^{n+2}} \\ &< 10^{-2^{n+2}} \end{aligned}$$

由数学归纳法 $\pi_n - \pi \le 10^{-2^{n+1}}$ 对 $n \ge 2$ 成立。



## 算法 2.2

令 $a_0=1, \ b_0=1/\sqrt{2}$，定义

$$\pi_n = \frac{2a_{n+1}^2}{1 - \sum_{k=0}^n 2^k c_k^2}$$

此外，$a_n, b_n$ 是 AGM 迭代数列 $c_n = \sqrt{a_n^2-b_n^2} = c_{n-1}^2/4a_n$，

那么有 $\pi_n$ 单调递增收敛到 $\pi$，且有

$$ \quad \pi - \pi_n \le \frac{\pi^2 2^{n+4} e^{-\pi 2^{n+1}}}{M^2(1, 1/\sqrt{2})} \tag{2.5.7}$$

且

$$ \quad \pi - \pi_{n+1} \le \frac{2^{-(n+1)}}{\pi^2} (\pi - \pi_n)^2 \tag{2.5.8}$$

Proof: 明显 $\lim a_{n+1}^2 = M^2(1, 1/\sqrt{2})$

由算法 1.2 (b) $E(k) = (1 - \sum_{n=0}^{\infty} 2^{n-1} c_n^2) K(k)$。来计算 $\pi_n$ 分母的极限。

令 $k=\frac{1}{\sqrt{2}}$，则

$$1 - \sum_{n=0}^{\infty} 2^{n-1} c_n^2 = \frac{E(1/\sqrt{2})}{K(1/\sqrt{2})}$$

看分母

$$\sum_{n=0}^{\infty} 2^n c_n^2 = 2 - 2 \frac{E(1/\sqrt{2})}{K(1/\sqrt{2})}$$


又 $(2E-K)K = \frac{\pi}{2}$ (勒让德关系式 $k=\frac{1}{\sqrt{2}}$! 则 有 $2\frac{E}{K} - 1 = \frac{\pi}{2K^2}$)

$$\begin{aligned} 1 - \sum_{n=0}^{\infty} 2^n c_n^2 &= 1 - (2 - 2\frac{E}{K}) \\ &= 1 - 2 + 2\frac{E}{K} \\ &= -1 + \frac{\pi}{2K^2} + 1 \\ &= \frac{\pi}{2K^2} = \frac{\pi}{2} \frac{4}{\pi^2} M^2(1, 1/\sqrt{2}) = \frac{2}{\pi} M^2(1, 1/\sqrt{2}) \end{aligned}$$

$$\therefore \quad \lim_{n \to \infty} \pi_n = 2 \frac{M^2(1, 1/\sqrt{2})}{\frac{2}{\pi} M^2(1, 1/\sqrt{2})} = \pi$$
则有
$$
\pi=\frac{2M^2(1,1/\sqrt{2})}{1-\sum_{k=0}^\infty2^k c_k^2}\tag{2.5.9}
$$
对于收敛速度估计(2.5.7)和(2.5.8)留作习题，待做。


如果使用 $K$ 的微分，重写 勒让德关键式 (1.6.2)

$$\quad \frac{\pi}{2} = k k'^2 (\dot{K} K' - K \dot{K}') \tag{2.5.10}$$

由于 $\dot{K}(k') = \frac{\pi}{2} \frac{k'}{k} \frac{\dot{M}(1,k)}{M^2(1,k)}$， 又 $\dot{K}'(k) = -\frac{k}{k'} \dot{K}(k')$

$\hookrightarrow k' \to k, \quad \dot{K}(k) = \frac{\pi}{2} \frac{k}{k'} \frac{\dot{M}(1,k')}{M^2(1,k')}$

$$= - \frac{\pi}{2} \frac{\dot{M}(1,k)}{M^2(1,k)}$$

代入 2.5.10 有

$$\frac{\pi}{2} = k k'^2 K' \frac{\pi}{2} \frac{k}{k'} \frac{\dot{M}(1,k')}{M^2(1,k')} - k k'^2 \left(-\frac{\pi}{2}\right) K \frac{\dot{M}(1,k)}{M^2(1,k)}$$

$$= \frac{\pi}{2} k^2 k' K' \frac{\dot{M}(1,k')}{M^2(1,k')} + \frac{\pi}{2} k k'^2 K \frac{\dot{M}(1,k)}{M^2(1,k)}$$

$$= \left(\frac{\pi}{2}\right)^2 k' k^2 \frac{K'}{K} \frac{\dot{M}(1,k')}{M^3(1,k')} + \left(\frac{\pi}{2}\right)^2 k k'^2 \frac{K}{K'} \frac{\dot{M}(1,k)}{M^3(1,k)}$$

$$ \quad \frac{2}{\pi} = k' k^2 \frac{K'(k)}{K(k)} \frac{\dot{M}(1,k')}{M^3(1,k')} + k k'^2 \frac{K(k)}{K'(k)} \frac{\dot{M}(1,k)}{M^3(1,k)} \tag{2.5.11}$$

**存疑 (2.5.11)**

对于 $k k'^2 \frac{\dot{M}(1,k)}{M^3(1,k)}$ 的无穷乘积构造。 令 $a_0^*=1, \ b_0^*=k$.

和 $Q_n = k k'^2 \frac{\dot{a}_{n+1}^*}{a_{n+1}^* b_{n+1}^{*2}}$， 可行 $Q_0 = k k'^2 \frac{\dot{a}_1^*}{a_1^* b_1^{*2}} = k k'^2 \frac{\frac{0+1}{2}}{\frac{1+k}{2} k}$

$$= k'^2 \frac{1}{1+k} = \frac{1-k^2}{1+k} = 1-k$$

$$Q_n / Q_{n-1} = \frac{1+y_n^*}{1+x_n^*}$$

$$\text{则} \lim_{n \to \infty} Q_n = k k'^2 \frac{\dot{a}_{n+1}^*}{a_{n+1}^* b_{n+1}^{*2}} = Q_0 \prod_{n=1}^{\infty} \frac{Q_n}{Q_{n-1}} = (1-k) \prod_{n=1}^{\infty} \frac{1+y_n^*}{1+x_n^*}$$

**这没问题。但是到了 $k' k^2 \frac{\dot{M}(1,k')}{M^3(1,k')}$ 的无穷乘积构造，就麻烦了？**

令 $q_n = k' k^2 \frac{\dot{a}_{n+1}}{a_{n+1} b_{n+1}^2}, \quad q_0 = k' k^2 \frac{\frac{0 - k/k'}{2}}{k'(1+k')/2} = k' k^2 \left(-\frac{k}{k'}\right) \frac{1}{k'(1+k')}$

$$= - \frac{k}{k'} \frac{1-k'^2}{1+k'} = - \frac{k}{k'} (1-k')$$

$$q_n / q_{n-1} = \frac{1+y_n}{1+x_n}$$

$$\text{则} \lim_{n \to \infty} q_n = q_0 \prod_{n=1}^{\infty} \frac{q_n}{q_{n-1}} = -\frac{k}{k'} (1-k') \prod_{n=1}^{\infty} \frac{1+y_n}{1+x_n}$$

**多了一个 $(-k/k')$ 了。**



不对！ 若求 $\lim_{n \to \infty} \dot{a}_n$ ($a_0=1, \ b_0=k'$， $\dot{a}_n$ 对 $k$ 求导)，则

极限为 $\lim_{n \to \infty} \dot{a}_n = \dot{M}(1, k') \frac{d}{dk} M(1, k') = \dot{M}(1, k') (-\frac{k}{k'})$

则 $q_n = k' k^2 \frac{\dot{a}_{n+1}}{b_{n+1}^2 a_{n+1}}$ 不收敛到 $k' k^2 \frac{\dot{M}(1, k')}{M^3(1, k')}$

正确选 $\dot{M}(1, k') = - \frac{k'}{k} \lim \dot{a}_{n+1}$

令 $S_n = k' k^2 (-\frac{k'}{k}) \frac{\dot{a}_{n+1}}{b_{n+1}^2 a_{n+1}} = -k'^2 k \frac{\dot{a}_{n+1}}{b_{n+1}^2 a_{n+1}}$

此时 $\lim S_n = k' k^2 \frac{\dot{M}(1, k')}{M^3(1, k')}$， 且 $S_0$ 为：

$$\begin{aligned} S_0 &= -k'^2 k \frac{\dot{a}_1}{b_1^2 a_1} = -k'^2 k \frac{\frac{0-k/k'}{2}}{k' \frac{1+k'}{2}} = -k'^2 k \frac{(-k/k')}{k'(1+k')} \\ &= \frac{k^2}{1+k'} = \frac{1-k'^2}{1+k'} = 1-k' \end{aligned}$$

$$\therefore \quad \lim_{n \to \infty} S_n = S_0 \prod_{n=1}^{\infty} \frac{1+y_n}{1+x_n} = (1-k') \prod_{n=1}^{\infty} \frac{1+y_n}{1+x_n}$$

**则**

$$ \quad \pi = \frac{2}{(1-k') \frac{K'(k)}{K(k)} \prod_{n=1}^{\infty} (\frac{1+y_n}{1+x_n}) + (1-k) \frac{K(k)}{K'(k)} \prod_{n=1}^{\infty} (\frac{1+y_n^*}{1+x_n^*})} \tag{2.5.12}$$

其中 $x_0 = k'^{-1}, \ x_0^* = k^{-1}, \ y_1 = \sqrt{x_0}, \ y_1^* = \sqrt{x_0^*}$ (* 代表初值互补)。

(2.5.12) 适合 $K'(k)/K(k) =$ 有理数 的那些 $k$ (即奇异值)。

当 $k = \frac{1}{\sqrt{2}}$，上式变成 算法 2.1。

Salamin 提供了比 (2.5.9) 更一般的做法：

$$(2.5.13) \quad \pi = \frac{2 M(1, k) M(1, k')}{1 - \sum_{n=0}^{\infty} 2^{n-1} (c_n^2 + c_n^{*2})} \tag{2.5.13}$$